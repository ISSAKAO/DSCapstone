<!DOCTYPE html>
<!-- saved from url=(0046)http://www.foldl.me/2014/kneser-ney-smoothing/ -->
<html class="no-js" lang="en" prefix="og: http://ogp.me/ns#" style="" hc="a3"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta name="generator" content="GitHub Pages">

  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <!-- identity stuff -->
	<meta http-equiv="X-XRDS-Location" content="http://hansengel.myopenid.com/xrds?username=hansengel.myopenid.com">
	<meta name="microid" content="mailto+http:sha1:2b2811bc3da814ad4210e829e422c443f4b9d1e0">
	<link rel="openid.server" href="http://www.myopenid.com/server">
	<link rel="openid.delegate" href="http://hansengel.myopenid.com/">
	<link rel="openid2.provider" href="http://www.myopenid.com/server">
	<link rel="openid2.local_id" href="http://hansengel.myopenid.com/">

  <title>Kneser-Ney smoothing explained - foldl</title>

  
  <meta name="title" content="Kneser-Ney smoothing explained">
  <meta property="og:title" content="Kneser-Ney smoothing explained">
  <meta name="description" content="I explain a popular smoothing method applied to language models. The post describes Kneser-Ney as it applies to bigram language models and offers some intuition on why it works well.">
  <meta property="og:description" content="I explain a popular smoothing method applied to language models. The post describes Kneser-Ney as it applies to bigram language models and offers some intuition on why it works well.">
  <meta property="og:site_name" content="foldl">
  
  <meta name="author" content="Jon Gauthier">

  <meta name="viewport" content="width=device-width,initial-scale=1">

  <link rel="stylesheet" type="text/css" href="./Kneser-Ney smoothing explained - foldl_files/jquery.qtip.min.css">

  <link rel="stylesheet" type="text/css" href="./Kneser-Ney smoothing explained - foldl_files/style.css">
  <link rel="stylesheet" type="text/css" href="./Kneser-Ney smoothing explained - foldl_files/syntax.css"><!-- syntax highlighting -->
  <!--[if IE]>
      <link rel="stylesheet" type="text/css" href="/css/ie.css" />
  <![endif]-->

  <script type="text/javascript" async="" src="./Kneser-Ney smoothing explained - foldl_files/dc.js"></script><script src="./Kneser-Ney smoothing explained - foldl_files/modernizr-2.5.3.min.js"></script>
<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Hover_Arrow {position: absolute; width: 15px; height: 11px; cursor: pointer}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style class="winnerfm-style">.freefl-overlay{
    cursor: pointer;
    background-color: #3c3c3c;
    text-align: left;
    margin: 0px;
    padding: 0px;
    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3FpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo5Mjc5OWJhMS1jNzIwLTE5NGEtYTc1Ny1jNWIxODYyNTE2ZTciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTEyQjEzQkZENTAyMTFFM0I2ODg5NjQ1MjUxOERCMjIiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTEyQjEzQkVENTAyMTFFM0I2ODg5NjQ1MjUxOERCMjIiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjkyNzk5YmExLWM3MjAtMTk0YS1hNzU3LWM1YjE4NjI1MTZlNyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5Mjc5OWJhMS1jNzIwLTE5NGEtYTc1Ny1jNWIxODYyNTE2ZTciLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5GhQdBAAAFFklEQVR42uyc3VKzQAyGt5FWbXX0wBnv/7r0Bjzx31Zb234vBCNdYMlXgULJHnSg0JB9Jhv27+3o/v5+u926YDk7Ozs5OQnfAyOLxaIuU5+fn5vNJnzb6elpFEW1mJpMJuPx2FUVMlJKUjBFRkpJar1ek5FSkoqboZFSkiqFZaTypIphGalCUgWwjFQZKR+WkQqQ2oFlpMKkfmEZqUpSKSwjpSEVwzJSSlIxLCOlJAVT0RGT0pjSkwJ0MlJKUqGxoZHKN2QyUvqUR0ZK/3KIhkYKpr6+vvYg5UeWkQp3OH6twxv4ZKQCXbOoaVK3t7fZq+/v7x8fH3uQms1mFxcX2asPDw9iHHd+f3+DRXOkUlhNxxROxUt+yt4xBSKenzjFPXAMlcTBarVqiFQMq4XWBy8fHx9raX0ITC98cA/yLAzCw9Fo1BypGFb7eQpuERG8h038iquBY1R1kxQ2xTfjs6xx8dWm89QOrBZIgQJXDA7hTkQBnGNY+MQPs49A3V5fX/HN5eWlNL2np6fU3Z+QpKTIl4VVrZcU/IxaiClU5vr6WtqREFwul8wOj+C8BqfhOo6n02nqX1LOz8/5V5Ljl0nhkGQPOcc3RwqmohZaHx6DvCuBILXlusFdPuXczK7jubj68vKCkBTQ7DSHlTwRB2wHn/JlE6QKevBN5CmuSfgGbpJZoAg9dBe8VwHuyb8NOcQajani4U4TpDRlnBQPn9exkohrLaN7Q8io6XefEhZymUcBp5LgcJwH1zIpt/cia41DEE5VXE88HU1PmiF3GmZJ8VJe+6T8yDrIuI8TPDoKeANy5uJQws9vbm7Yn8rHtUDK7bHIWvsIGZ/z+ZyHLPwGxFV0tXDMvdZVUg5OKg72u7u7vs8ltLbMEzlbZFVPn9oi639MNNsiq5ZUxbqhkcqSiidLjJSSlDvWRdYmSJWODY1UoSkyUnpTZKT0pshI6U2RkdKbIiOlN0VGSm+KjJTeFBkp176S9ehJtbTIepBJwdpJ1aNkHQgp93cl63BIuT8qWQdFyv1FyTo0Uq4Li6x9IeX2U7IOk9TO5N+QtyEroZOR0ocnGSl9QyYjpU95ZKRcjYusRsopF1mNlFMushopV7nIOkmKS3bj8TdZSRFvP3t7e+s1Kd6hKvtURX4VIOUCW7vzkiLZ1z+dTtdJ6W9MuSL5VZiUK1SyrlYr3JSXFLFeCV2Nq6srGCpUFfWl9SGmPPlVJakUFqrNHQhggiHRfpT57RKNw5HlKRCAJyAQdxF+hEFZ+VUMC9dktzqOWe/hMpIitEe2znol2Xrdd1Iiv3KJugotBuHGu6QL5VfgmOqpWFuDa3lJkSQ/0St5kqKexlRWfoU3WNpHJyqTX8WwWPr3/PyMrzxJkQiIJCPmJUX9bX04XSwW3m15+RVOOYx+EzwCyvMe1r0En5cU9TpPwc9sd6Fw2Ac/QUpeZZErkRR5k4It56n2t/eVwfLfhp6kyEMzqI2Q+VYpniDSye1Kijwd15BJyauM1bTxgScpkq7DwEmxG3Cbu13pIqtIinB5npRwMz4aUmhPgZgCE/QV4BVIifwqFTrlM/qQW58UZKdsjzIaICmlKY9UASwjFTBFRkpvioyU3hQZKb0pMlJ6U2Sk9KbISLn+LrJ2llTnFlm7TMp1apG146Rc4O+CjVR+CElGSj/Yjg5OqjtbRiunJchI6SdwyEjpp7rISOknBclIKUmlCX6blE6ROuymtbLyT4ABAI0sAxAZwQU9AAAAAElFTkSuQmCC);
    background-position: 0 0;
    background-repeat: repeat;
    z-index: 999999;
    position: relative;
}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.4-beta-2') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.4-beta-2') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.4-beta-2') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.4-beta-2') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?rev=2.4-beta-2') format('opentype')}
</style></head>

<body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

  <div id="container">
    <aside id="topbar">
      <div class="inner">
        <h1><a href="http://www.foldl.me/">foldl</a></h1>

        <ul id="quick-links">
          <li><a href="http://www.foldl.me/">home</a></li>
          <li><a href="http://www.foldl.me/about.html">about</a></li>
          <li><a href="http://feeds.feedburner.com/foldl/rss">feed</a></li>
        </ul>
      </div>
    </aside>

    <section id="main" role="main">
      <div class="inner">
        <article id="single" class="hentry">
  <header>
    <h1 class="entry-title">
      
        Kneser-Ney smoothing explained
      
    </h1>
    <time datetime="2014-01-18T00:00:00+00:00">
      18 January 2014
    </time>
  </header>

  <div class="entry-content">
    <p><strong>Language models</strong> are an essential element of natural language processing,
  central to tasks ranging from spellchecking to machine translation. Given an
  arbitrary piece of text, a language model determines whether that text belongs
  to a given language.</p>

<p>We can give a concrete example with a <strong>probabilistic language model</strong>, a
specific construction which uses probabilities to estimate how likely any given
string belongs to a language. Consider a probabilistic English language model
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1" style="width: 1.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.299em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.53em 1000.002em 2.641em -0.368em); top: -2.359em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 1.252em; height: 0px;"><span style="position: absolute; clip: rect(1.762em 1000.002em 2.734em -0.368em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-4" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.65em;"><span class="mi" id="MathJax-Span-5" style="font-size: 70.7%; font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.114em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1"> P_E </script>. We would expect the probability</p>

<p><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-2-Frame"><nobr><span class="math" id="MathJax-Span-6" style="width: 11.9em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.91em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.854em 1000.002em 3.104em -0.368em); top: -2.729em; left: 0.002em;"><span class="mrow" id="MathJax-Span-7"><span class="msubsup" id="MathJax-Span-8"><span style="display: inline-block; position: relative; width: 1.252em; height: 0px;"><span style="position: absolute; clip: rect(1.762em 1000.002em 2.734em -0.368em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.65em;"><span class="mi" id="MathJax-Span-10" style="font-size: 70.7%; font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-11" style="font-family: MathJax_Main;">(</span><span class="mtext" id="MathJax-Span-12" style="font-family: MathJax_Main;">I went to the store</span><span class="mo" id="MathJax-Span-13" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.734em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.336em; vertical-align: -0.331em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-2">P_E(\text{I went to the store})</script></p>

<p>to be quite high, since we can confirm this is valid English. On the other hand,
we expect the probabilities</p>

<p><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-3-Frame"><nobr><span class="math" id="MathJax-Span-14" style="width: 24.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.419em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.854em 1000.002em 3.104em -0.368em); top: -2.729em; left: 0.002em;"><span class="mrow" id="MathJax-Span-15"><span class="msubsup" id="MathJax-Span-16"><span style="display: inline-block; position: relative; width: 1.252em; height: 0px;"><span style="position: absolute; clip: rect(1.762em 1000.002em 2.734em -0.368em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-17" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.65em;"><span class="mi" id="MathJax-Span-18" style="font-size: 70.7%; font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-19" style="font-family: MathJax_Main;">(</span><span class="mtext" id="MathJax-Span-20" style="font-family: MathJax_Main;">store went to I the</span><span class="mo" id="MathJax-Span-21" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-22" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-23" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.252em; height: 0px;"><span style="position: absolute; clip: rect(1.762em 1000.002em 2.734em -0.368em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.65em;"><span class="mi" id="MathJax-Span-25" style="font-size: 70.7%; font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-26" style="font-family: MathJax_Main;">(</span><span class="mtext" id="MathJax-Span-27" style="font-family: MathJax_Main;">Ich habe eine Katz</span><span class="mo" id="MathJax-Span-28" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.734em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.336em; vertical-align: -0.331em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-3">P_E(\text{store went to I the}), P_E(\text{Ich habe eine Katz})</script></p>

<p>to be very low, since these fragments do not constitute proper English text.</p>

<p>I don’t aim to cover the entirety of language models at the moment — that
would be an ambitious task for a single blog post. If you haven’t encountered
language models or <em>n</em>-grams before, I recommend the following resources:</p>

<ul>
  <li><a href="http://en.wikipedia.org/wiki/Language_model">“Language model”</a> on Wikipedia</li>
  <li>Chapter 4 of Jurafsky and Martin’s <a href="http://www.amazon.com/gp/product/0131873210/ref=as_li_qf_sp_asin_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=0131873210&linkCode=as2&tag=blog0cbb-20"><em>Speech and Language Processing</em></a></li>
  <li>Chapter 7 of <a href="http://www.amazon.com/gp/product/0521874157/ref=as_li_tf_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=0521874157&linkCode=as2&tag=blog0cbb-20"><em>Statistical Machine Translation</em></a> (see <a href="http://www.statmt.org/book/slides/07-language-models.pdf">summary slides</a> online)</li>
</ul>

<p>I’d like to jump ahead to a trickier subject within language modeling known as
<strong>Kneser-Ney smoothing</strong>. This smoothing method is most commonly applied in an
<em>interpolated</em> form,<sup id="fnref:1"><a href="http://www.foldl.me/2014/kneser-ney-smoothing/#fn:1" class="footnote" data-hasqtip="0">1</a></sup> and this is the form that I’ll present today.</p>

<p>Kneser-Ney evolved from <strong>absolute-discounting interpolation</strong>, which makes use
of both higher-order (i.e., higher-<em>n</em>) and lower-order language models,
reallocating some probability mass from 4-grams or 3-grams to simpler unigram
models. The formula for absolute-discounting smoothing as applied to a bigram
language model is presented below:</p>

<p><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-4-Frame"><nobr><span class="math" id="MathJax-Span-29" style="width: 27.178em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.641em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.16em 1000.002em 3.891em -0.368em); top: -2.729em; left: 0.002em;"><span class="mrow" id="MathJax-Span-30"><span class="msubsup" id="MathJax-Span-31"><span style="display: inline-block; position: relative; width: 1.715em; height: 0px;"><span style="position: absolute; clip: rect(1.762em 1000.002em 2.734em -0.368em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-32" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.65em;"><span class="texatom" id="MathJax-Span-33"><span class="mrow" id="MathJax-Span-34"><span class="mi" id="MathJax-Span-35" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-36" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-37" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-39"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-40" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.743em;"><span class="mi" id="MathJax-Span-41" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-42" style="font-family: MathJax_Main; padding-left: 0.28em;">∣</span><span class="msubsup" id="MathJax-Span-43" style="padding-left: 0.28em;"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.743em;"><span class="texatom" id="MathJax-Span-45"><span class="mrow" id="MathJax-Span-46"><span class="mi" id="MathJax-Span-47" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-48" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-49" style="font-family: MathJax_Main; padding-left: 0.28em;">=</span><span class="mstyle" id="MathJax-Span-50" style="padding-left: 0.28em;"><span class="mrow" id="MathJax-Span-51"><span class="mfrac" id="MathJax-Span-52"><span style="display: inline-block; position: relative; width: 9.771em; height: 0px; margin-right: 0.141em; margin-left: 0.141em;"><span style="position: absolute; clip: rect(1.854em 1000.002em 3.104em -0.368em); top: -3.424em; left: 50%; margin-left: -4.813em;"><span class="mrow" id="MathJax-Span-53"><span class="mo" id="MathJax-Span-54" style="font-family: MathJax_Main;">max</span><span class="mo" id="MathJax-Span-55" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-57" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-58"><span style="display: inline-block; position: relative; width: 1.993em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-59" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-60"><span class="mrow" id="MathJax-Span-61"><span class="mi" id="MathJax-Span-62" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-63" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-64" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-65"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-66" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.743em;"><span class="mi" id="MathJax-Span-67" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-68" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-69" style="font-family: MathJax_Main; padding-left: 0.234em;">−</span><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math-italic; padding-left: 0.234em;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-71" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-72" style="font-family: MathJax_Main; padding-left: 0.188em;">0</span><span class="mo" id="MathJax-Span-73" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.734em;"></span></span><span style="position: absolute; clip: rect(1.854em 1000.002em 3.15em -0.368em); top: -2.035em; left: 50%; margin-left: -3.146em;"><span class="mrow" id="MathJax-Span-74"><span class="munderover" id="MathJax-Span-75"><span style="display: inline-block; position: relative; width: 1.854em; height: 0px;"><span style="position: absolute; clip: rect(1.854em 1000.002em 3.104em -0.368em); top: -2.729em; left: 0.002em;"><span class="mo" id="MathJax-Span-76" style="font-family: MathJax_Size1; vertical-align: 0.002em;">∑</span><span style="display: inline-block; width: 0px; height: 2.734em;"></span></span><span style="position: absolute; top: -3.701em; left: 1.067em;"><span class="texatom" id="MathJax-Span-77"><span class="mrow" id="MathJax-Span-78"><span class="msup" id="MathJax-Span-79"><span style="display: inline-block; position: relative; width: 0.697em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.595em -0.414em); top: -2.451em; left: 0.002em;"><span class="mi" id="MathJax-Span-80" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span><span style="position: absolute; top: -2.544em; left: 0.512em;"><span class="mo" id="MathJax-Span-81" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">c</span><span class="mo" id="MathJax-Span-83" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-84"><span style="display: inline-block; position: relative; width: 1.993em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-85" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-86"><span class="mrow" id="MathJax-Span-87"><span class="mi" id="MathJax-Span-88" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-89" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-90" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="msup" id="MathJax-Span-91"><span style="display: inline-block; position: relative; width: 1.067em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-92" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.775em; left: 0.743em;"><span class="mo" id="MathJax-Span-93" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-94" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.734em;"></span></span><span style="position: absolute; clip: rect(0.882em 1000.002em 1.206em -0.414em); top: -1.294em; left: 0.002em;"><span style="border-left-width: 9.771em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.049em; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.067em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-95" style="font-family: MathJax_Main; padding-left: 0.234em;">+</span><span class="mi" id="MathJax-Span-96" style="font-family: MathJax_Math-italic; padding-left: 0.234em;">α</span><span class="mspace" id="MathJax-Span-97" style="height: 0.002em; vertical-align: 0.002em; width: 0.28em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-98"><span style="display: inline-block; position: relative; width: 1.623em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.919em -0.461em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-99" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.22em; left: 0.512em;"><span class="texatom" id="MathJax-Span-100"><span class="mrow" id="MathJax-Span-101"><span class="mi" id="MathJax-Span-102" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-103" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-104" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-105" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-106"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-107" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.743em;"><span class="mi" id="MathJax-Span-108" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-109" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.734em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.058em; vertical-align: -1.275em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-4">P_{abs}(w_i \mid w_{i}) = \dfrac{\max(c(w_{i-1} w_i) - \delta, 0)}{\sum_{w'} c(w_{i-1} w')} + \alpha\; p_{abs}(w_i)</script></p>

<p>Here <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-5-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-110" style="width: 0.558em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.465em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.762em 1000.002em 2.734em -0.368em); top: -2.59em; left: 0.002em;"><span class="mrow" id="MathJax-Span-111"><span class="mi" id="MathJax-Span-112" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.003em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">\delta</script> refers to a fixed <strong>discount</strong> value, and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-113" style="width: 0.789em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.65em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.368em); top: -2.59em; left: 0.002em;"><span class="mrow" id="MathJax-Span-114"><span class="mi" id="MathJax-Span-115" style="font-family: MathJax_Math-italic;">α</span></span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.669em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">\alpha</script> is a
normalizing constant. The details of this smoothing are covered in
<a href="http://u.cs.biu.ac.il/~yogo/courses/mt2013/papers/chen-goodman-99.pdf">Chen and Goodman (1999)</a>.</p>

<p>The essence of Kneser-Ney is in the clever observation that we can take
advantage of this interpolation as a sort of backoff model. When the first term
(in this case, the discounted relative bigram count) is near zero, the second
term (the lower-order model) carries more weight. Inversely, when the
higher-order model matches strongly, the second lower-order term has little
weight.</p>

<p>The Kneser-Ney design retains the first term of absolute discounting
interpolation, but rewrites the second term to take advantage of this
relationship. Whereas absolute discounting interpolation in a bigram model would
simply default to a unigram model in the second term, Kneser-Ney depends upon
the idea of a <em>continuation probability</em> associated with each unigram.</p>

<p>This probability for a given token <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-116" style="width: 1.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.16em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.762em 1000.002em 2.641em -0.414em); top: -2.359em; left: 0.002em;"><span class="mrow" id="MathJax-Span-117"><span class="msubsup" id="MathJax-Span-118"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-119" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.743em;"><span class="mi" id="MathJax-Span-120" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.836em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">w_i</script> is proportional to the <strong>number of
bigrams which it completes</strong>:</p>

<p><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-8-Frame"><nobr><span class="math" id="MathJax-Span-121" style="width: 23.289em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.4em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.854em 1000.002em 3.104em -0.368em); top: -2.729em; left: 0.002em;"><span class="mrow" id="MathJax-Span-122"><span class="msubsup" id="MathJax-Span-123"><span style="display: inline-block; position: relative; width: 4.632em; height: 0px;"><span style="position: absolute; clip: rect(1.762em 1000.002em 2.734em -0.368em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-124" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.65em;"><span class="texatom" id="MathJax-Span-125"><span class="mrow" id="MathJax-Span-126"><span class="mtext" id="MathJax-Span-127" style="font-size: 70.7%; font-family: MathJax_Main;">continuation</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-128" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-129"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-130" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.743em;"><span class="mi" id="MathJax-Span-131" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-132" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-133" style="font-family: MathJax_Main; padding-left: 0.28em;">∝</span><span class="mspace" id="MathJax-Span-134" style="height: 0.002em; vertical-align: 0.002em; width: 0.234em; display: inline-block; overflow: hidden;"></span><span class="mrow" id="MathJax-Span-135" style="padding-left: 0.28em;"><span class="mo" id="MathJax-Span-136" style="vertical-align: 0.002em; padding-left: 0.28em;"><span style="font-family: MathJax_Main;">|</span></span><span class="mo" id="MathJax-Span-137" style="font-family: MathJax_Main;">{</span><span class="msubsup" id="MathJax-Span-138"><span style="display: inline-block; position: relative; width: 1.993em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-139" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-140"><span class="mrow" id="MathJax-Span-141"><span class="mi" id="MathJax-Span-142" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-143" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-144" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-145" style="font-family: MathJax_Main; padding-left: 0.28em;">:</span><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Math-italic; padding-left: 0.28em;">c</span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-148"><span style="display: inline-block; position: relative; width: 1.993em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-149" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-150"><span class="mrow" id="MathJax-Span-151"><span class="mi" id="MathJax-Span-152" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-153" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-154" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-155" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-156" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-157" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.743em;"><span class="mi" id="MathJax-Span-158" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-159" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-160" style="font-family: MathJax_Main; padding-left: 0.28em;">&gt;</span><span class="mn" id="MathJax-Span-161" style="font-family: MathJax_Main; padding-left: 0.28em;">0</span><span class="mo" id="MathJax-Span-162" style="font-family: MathJax_Main;">}</span><span class="mo" id="MathJax-Span-163" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.734em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.336em; vertical-align: -0.331em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-8">P_{\text{continuation}}(w_i) \propto \: \left| \{ w_{i-1} : c(w_{i-1}, w_i) > 0 \} \right|</script></p>

<p>This quantity is normalized by dividing by the total number of bigram types
(note that <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-9-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-164" style="width: 0.512em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.419em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.808em 1000.002em 2.919em -0.414em); top: -2.59em; left: 0.002em;"><span class="mrow" id="MathJax-Span-165"><span class="mi" id="MathJax-Span-166" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.169em; vertical-align: -0.275em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">j</script> is a free variable):</p>

<p><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-10-Frame"><nobr><span class="math" id="MathJax-Span-167" style="width: 23.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.447em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.16em 1000.002em 3.938em -0.368em); top: -2.729em; left: 0.002em;"><span class="mrow" id="MathJax-Span-168"><span class="msubsup" id="MathJax-Span-169"><span style="display: inline-block; position: relative; width: 4.632em; height: 0px;"><span style="position: absolute; clip: rect(1.762em 1000.002em 2.734em -0.368em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-170" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.65em;"><span class="texatom" id="MathJax-Span-171"><span class="mrow" id="MathJax-Span-172"><span class="mtext" id="MathJax-Span-173" style="font-size: 70.7%; font-family: MathJax_Main;">continuation</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-174" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-175"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-176" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.743em;"><span class="mi" id="MathJax-Span-177" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-178" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-179" style="font-family: MathJax_Main; padding-left: 0.28em;">=</span><span class="mstyle" id="MathJax-Span-180" style="padding-left: 0.28em;"><span class="mrow" id="MathJax-Span-181"><span class="mfrac" id="MathJax-Span-182"><span style="display: inline-block; position: relative; width: 11.299em; height: 0px; margin-right: 0.141em; margin-left: 0.141em;"><span style="position: absolute; clip: rect(1.854em 1000.002em 3.104em -0.275em); top: -3.424em; left: 50%; margin-left: -5.507em;"><span class="mrow" id="MathJax-Span-183"><span class="mo" id="MathJax-Span-184" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Main;">|</span></span><span class="mo" id="MathJax-Span-185" style="font-family: MathJax_Main;">{</span><span class="msubsup" id="MathJax-Span-186"><span style="display: inline-block; position: relative; width: 1.993em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-187" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-188"><span class="mrow" id="MathJax-Span-189"><span class="mi" id="MathJax-Span-190" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-191" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-192" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-193" style="font-family: MathJax_Main; padding-left: 0.28em;">:</span><span class="mi" id="MathJax-Span-194" style="font-family: MathJax_Math-italic; padding-left: 0.28em;">c</span><span class="mo" id="MathJax-Span-195" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-196"><span style="display: inline-block; position: relative; width: 1.993em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-197" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-198"><span class="mrow" id="MathJax-Span-199"><span class="mi" id="MathJax-Span-200" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-201" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-202" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-203" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-204" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-205" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.743em;"><span class="mi" id="MathJax-Span-206" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-207" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-208" style="font-family: MathJax_Main; padding-left: 0.28em;">&gt;</span><span class="mn" id="MathJax-Span-209" style="font-family: MathJax_Main; padding-left: 0.28em;">0</span><span class="mo" id="MathJax-Span-210" style="font-family: MathJax_Main;">}</span><span class="mo" id="MathJax-Span-211" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 2.734em;"></span></span><span style="position: absolute; clip: rect(2.502em 1000.002em 3.845em -0.414em); top: -2.683em; left: 50%; margin-left: -5.553em;"><span class="mrow" id="MathJax-Span-212"><span class="mo" id="MathJax-Span-213" style="vertical-align: 0.789em;"><span style="display: inline-block; position: relative; width: 0.28em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.238em; left: 0.002em;">∣<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.146em; left: 0.002em;">∣<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-214" style="font-family: MathJax_Main;">{</span><span class="msubsup" id="MathJax-Span-215"><span style="display: inline-block; position: relative; width: 2.039em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-216" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-217"><span class="mrow" id="MathJax-Span-218"><span class="mi" id="MathJax-Span-219" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-220" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-221" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-222" style="font-family: MathJax_Main; padding-left: 0.28em;">:</span><span class="mi" id="MathJax-Span-223" style="font-family: MathJax_Math-italic; padding-left: 0.28em;">c</span><span class="mo" id="MathJax-Span-224" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-225"><span style="display: inline-block; position: relative; width: 2.039em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-226" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-227"><span class="mrow" id="MathJax-Span-228"><span class="mi" id="MathJax-Span-229" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-230" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-231" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-232" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-233" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.16em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-234" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.743em;"><span class="mi" id="MathJax-Span-235" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-236" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-237" style="font-family: MathJax_Main; padding-left: 0.28em;">&gt;</span><span class="mn" id="MathJax-Span-238" style="font-family: MathJax_Main; padding-left: 0.28em;">0</span><span class="mo" id="MathJax-Span-239" style="font-family: MathJax_Main;">}</span><span class="mo" id="MathJax-Span-240" style="vertical-align: 0.789em;"><span style="display: inline-block; position: relative; width: 0.28em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.238em; left: 0.002em;">∣<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.146em; left: 0.002em;">∣<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.428em;"></span></span><span style="position: absolute; clip: rect(0.882em 1000.002em 1.206em -0.414em); top: -1.294em; left: 0.002em;"><span style="border-left-width: 11.299em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.049em; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.067em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.734em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.114em; vertical-align: -1.331em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-10">P_{\text{continuation}}(w_i) = \dfrac{\left| \{ w_{i-1} : c(w_{i-1}, w_i) > 0 \} \right|}{\left| \{ w_{j-1} : c(w_{j-1},w_j) > 0\} \right|}</script></p>

<p>The common example used to demonstrate the efficacy of Kneser-Ney is the phrase
<em>San Francisco</em>. Suppose this phrase is abundant in a given training corpus.
Then the unigram probability of <em>Francisco</em> will also be high. If we unwisely
use something like absolute discounting interpolation in a context where our
bigram model is weak, the unigram model portion may take over and lead to some
strange results.</p>

<p><a href="https://www.youtube.com/watch?v=wtB00EczoCM">Dan Jurafsky</a> gives the following example context:</p>

<blockquote>
  <p>I can’t see without my reading <strong>__</strong>___.</p>
</blockquote>

<p>A fluent English speaker reading this sentence knows that the word <em>glasses</em>
should fill in the blank. But since <em>San Francisco</em> is a common term,
absolute-discounting interpolation might declare that <em>Francisco</em> is a better
fit: <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-11-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-241" style="width: 16.113em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.428em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.854em 1000.002em 3.104em -0.368em); top: -2.729em; left: 0.002em;"><span class="mrow" id="MathJax-Span-242"><span class="msubsup" id="MathJax-Span-243"><span style="display: inline-block; position: relative; width: 1.715em; height: 0px;"><span style="position: absolute; clip: rect(1.762em 1000.002em 2.734em -0.368em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-244" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.65em;"><span class="texatom" id="MathJax-Span-245"><span class="mrow" id="MathJax-Span-246"><span class="mi" id="MathJax-Span-247" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-248" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-249" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-250" style="font-family: MathJax_Main;">(</span><span class="mtext" id="MathJax-Span-251" style="font-family: MathJax_Main;">Francisco</span><span class="mo" id="MathJax-Span-252" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-253" style="font-family: MathJax_Main; padding-left: 0.28em;">&gt;</span><span class="msubsup" id="MathJax-Span-254" style="padding-left: 0.28em;"><span style="display: inline-block; position: relative; width: 1.715em; height: 0px;"><span style="position: absolute; clip: rect(1.762em 1000.002em 2.734em -0.368em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-255" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.65em;"><span class="texatom" id="MathJax-Span-256"><span class="mrow" id="MathJax-Span-257"><span class="mi" id="MathJax-Span-258" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-259" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-260" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-261" style="font-family: MathJax_Main;">(</span><span class="mtext" id="MathJax-Span-262" style="font-family: MathJax_Main;">glasses</span><span class="mo" id="MathJax-Span-263" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.734em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.336em; vertical-align: -0.331em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">P_{abs}(\text{Francisco}) > P_{abs}(\text{glasses})</script>.</p>

<p>Kneser-Ney fixes this problem by asking a slightly harder question of our
lower-order model. Whereas the unigram model simply provides how likely a word
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-12-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-264" style="width: 1.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.16em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.762em 1000.002em 2.641em -0.414em); top: -2.359em; left: 0.002em;"><span class="mrow" id="MathJax-Span-265"><span class="msubsup" id="MathJax-Span-266"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-267" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.743em;"><span class="mi" id="MathJax-Span-268" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.836em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">w_i</script> is to appear, Kneser-Ney’s second term determines how likely a word
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-13-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-269" style="width: 1.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.16em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.762em 1000.002em 2.641em -0.414em); top: -2.359em; left: 0.002em;"><span class="mrow" id="MathJax-Span-270"><span class="msubsup" id="MathJax-Span-271"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-272" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.743em;"><span class="mi" id="MathJax-Span-273" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.836em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">w_i</script> is to appear in an unfamiliar bigram context.</p>

<p>Kneser-Ney in whole follows:</p>

<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-14-Frame"><nobr><span class="math" id="MathJax-Span-274" style="width: 37.826em; display: inline-block;"><span style="display: inline-block; position: relative; width: 31.53em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.16em 1000.002em 3.938em -0.368em); top: -2.729em; left: 0.002em;"><span class="mrow" id="MathJax-Span-275"><span class="msubsup" id="MathJax-Span-276"><span style="display: inline-block; position: relative; width: 1.808em; height: 0px;"><span style="position: absolute; clip: rect(1.762em 1000.002em 2.734em -0.368em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-277" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.65em;"><span class="texatom" id="MathJax-Span-278"><span class="mrow" id="MathJax-Span-279"><span class="texatom" id="MathJax-Span-280"><span class="mrow" id="MathJax-Span-281"><span class="mi" id="MathJax-Span-282" style="font-size: 70.7%; font-family: MathJax_Main-italic;">K</span><span class="mi" id="MathJax-Span-283" style="font-size: 70.7%; font-family: MathJax_Main-italic;">N</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-284" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-285"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-286" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.743em;"><span class="mi" id="MathJax-Span-287" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-288" style="font-family: MathJax_Main; padding-left: 0.28em;">∣</span><span class="msubsup" id="MathJax-Span-289" style="padding-left: 0.28em;"><span style="display: inline-block; position: relative; width: 1.993em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-290" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-291"><span class="mrow" id="MathJax-Span-292"><span class="mi" id="MathJax-Span-293" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-294" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-295" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-296" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-297" style="font-family: MathJax_Main; padding-left: 0.28em;">=</span><span class="mstyle" id="MathJax-Span-298" style="padding-left: 0.28em;"><span class="mrow" id="MathJax-Span-299"><span class="mfrac" id="MathJax-Span-300"><span style="display: inline-block; position: relative; width: 9.771em; height: 0px; margin-right: 0.141em; margin-left: 0.141em;"><span style="position: absolute; clip: rect(1.854em 1000.002em 3.104em -0.368em); top: -3.424em; left: 50%; margin-left: -4.813em;"><span class="mrow" id="MathJax-Span-301"><span class="mo" id="MathJax-Span-302" style="font-family: MathJax_Main;">max</span><span class="mo" id="MathJax-Span-303" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-304" style="font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-305" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-306"><span style="display: inline-block; position: relative; width: 1.993em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-307" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-308"><span class="mrow" id="MathJax-Span-309"><span class="mi" id="MathJax-Span-310" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-311" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-312" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-313"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-314" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.743em;"><span class="mi" id="MathJax-Span-315" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-316" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-317" style="font-family: MathJax_Main; padding-left: 0.234em;">−</span><span class="mi" id="MathJax-Span-318" style="font-family: MathJax_Math-italic; padding-left: 0.234em;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-319" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-320" style="font-family: MathJax_Main; padding-left: 0.188em;">0</span><span class="mo" id="MathJax-Span-321" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.734em;"></span></span><span style="position: absolute; clip: rect(1.854em 1000.002em 3.15em -0.368em); top: -2.035em; left: 50%; margin-left: -3.146em;"><span class="mrow" id="MathJax-Span-322"><span class="munderover" id="MathJax-Span-323"><span style="display: inline-block; position: relative; width: 1.854em; height: 0px;"><span style="position: absolute; clip: rect(1.854em 1000.002em 3.104em -0.368em); top: -2.729em; left: 0.002em;"><span class="mo" id="MathJax-Span-324" style="font-family: MathJax_Size1; vertical-align: 0.002em;">∑</span><span style="display: inline-block; width: 0px; height: 2.734em;"></span></span><span style="position: absolute; top: -3.701em; left: 1.067em;"><span class="texatom" id="MathJax-Span-325"><span class="mrow" id="MathJax-Span-326"><span class="msup" id="MathJax-Span-327"><span style="display: inline-block; position: relative; width: 0.697em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.595em -0.414em); top: -2.451em; left: 0.002em;"><span class="mi" id="MathJax-Span-328" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span><span style="position: absolute; top: -2.544em; left: 0.512em;"><span class="mo" id="MathJax-Span-329" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-330" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">c</span><span class="mo" id="MathJax-Span-331" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-332"><span style="display: inline-block; position: relative; width: 1.993em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-333" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-334"><span class="mrow" id="MathJax-Span-335"><span class="mi" id="MathJax-Span-336" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-337" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-338" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="msup" id="MathJax-Span-339"><span style="display: inline-block; position: relative; width: 1.067em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-340" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.775em; left: 0.743em;"><span class="mo" id="MathJax-Span-341" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-342" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.734em;"></span></span><span style="position: absolute; clip: rect(0.882em 1000.002em 1.206em -0.414em); top: -1.294em; left: 0.002em;"><span style="border-left-width: 9.771em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.049em; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.067em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-343" style="font-family: MathJax_Main; padding-left: 0.234em;">+</span><span class="mi" id="MathJax-Span-344" style="font-family: MathJax_Math-italic; padding-left: 0.234em;">λ</span><span class="mstyle" id="MathJax-Span-345" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-346"><span class="mfrac" id="MathJax-Span-347"><span style="display: inline-block; position: relative; width: 11.299em; height: 0px; margin-right: 0.141em; margin-left: 0.141em;"><span style="position: absolute; clip: rect(1.854em 1000.002em 3.104em -0.275em); top: -3.424em; left: 50%; margin-left: -5.507em;"><span class="mrow" id="MathJax-Span-348"><span class="mo" id="MathJax-Span-349" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Main;">|</span></span><span class="mo" id="MathJax-Span-350" style="font-family: MathJax_Main;">{</span><span class="msubsup" id="MathJax-Span-351"><span style="display: inline-block; position: relative; width: 1.993em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-352" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-353"><span class="mrow" id="MathJax-Span-354"><span class="mi" id="MathJax-Span-355" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-356" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-357" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-358" style="font-family: MathJax_Main; padding-left: 0.28em;">:</span><span class="mi" id="MathJax-Span-359" style="font-family: MathJax_Math-italic; padding-left: 0.28em;">c</span><span class="mo" id="MathJax-Span-360" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-361"><span style="display: inline-block; position: relative; width: 1.993em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-362" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-363"><span class="mrow" id="MathJax-Span-364"><span class="mi" id="MathJax-Span-365" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-366" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-367" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-368" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-369" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-370" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.743em;"><span class="mi" id="MathJax-Span-371" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-372" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-373" style="font-family: MathJax_Main; padding-left: 0.28em;">&gt;</span><span class="mn" id="MathJax-Span-374" style="font-family: MathJax_Main; padding-left: 0.28em;">0</span><span class="mo" id="MathJax-Span-375" style="font-family: MathJax_Main;">}</span><span class="mo" id="MathJax-Span-376" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 2.734em;"></span></span><span style="position: absolute; clip: rect(2.502em 1000.002em 3.845em -0.414em); top: -2.683em; left: 50%; margin-left: -5.553em;"><span class="mrow" id="MathJax-Span-377"><span class="mo" id="MathJax-Span-378" style="vertical-align: 0.789em;"><span style="display: inline-block; position: relative; width: 0.28em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.238em; left: 0.002em;">∣<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.146em; left: 0.002em;">∣<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-379" style="font-family: MathJax_Main;">{</span><span class="msubsup" id="MathJax-Span-380"><span style="display: inline-block; position: relative; width: 2.039em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-381" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-382"><span class="mrow" id="MathJax-Span-383"><span class="mi" id="MathJax-Span-384" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-385" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-386" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-387" style="font-family: MathJax_Main; padding-left: 0.28em;">:</span><span class="mi" id="MathJax-Span-388" style="font-family: MathJax_Math-italic; padding-left: 0.28em;">c</span><span class="mo" id="MathJax-Span-389" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-390"><span style="display: inline-block; position: relative; width: 2.039em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-391" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-392"><span class="mrow" id="MathJax-Span-393"><span class="mi" id="MathJax-Span-394" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-395" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-396" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-397" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-398" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.16em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-399" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.743em;"><span class="mi" id="MathJax-Span-400" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-401" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-402" style="font-family: MathJax_Main; padding-left: 0.28em;">&gt;</span><span class="mn" id="MathJax-Span-403" style="font-family: MathJax_Main; padding-left: 0.28em;">0</span><span class="mo" id="MathJax-Span-404" style="font-family: MathJax_Main;">}</span><span class="mo" id="MathJax-Span-405" style="vertical-align: 0.789em;"><span style="display: inline-block; position: relative; width: 0.28em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.238em; left: 0.002em;">∣<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.146em; left: 0.002em;">∣<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.428em;"></span></span><span style="position: absolute; clip: rect(0.882em 1000.002em 1.206em -0.414em); top: -1.294em; left: 0.002em;"><span style="border-left-width: 11.299em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.049em; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.067em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.734em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.114em; vertical-align: -1.331em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-14">P_{\mathit{KN}}(w_i \mid w_{i-1}) = \dfrac{\max(c(w_{i-1} w_i) - \delta, 0)}{\sum_{w'} c(w_{i-1} w')} + \lambda \dfrac{\left| \{ w_{i-1} : c(w_{i-1}, w_i) > 0 \} \right|}{\left| \{ w_{j-1} : c(w_{j-1},w_j) > 0\} \right|}</script>

<p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-15-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-406" style="width: 0.743em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.604em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.762em 1000.002em 2.734em -0.368em); top: -2.59em; left: 0.002em;"><span class="mrow" id="MathJax-Span-407"><span class="mi" id="MathJax-Span-408" style="font-family: MathJax_Math-italic;">λ</span></span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.947em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">\lambda</script> is a normalizing constant</p>

<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-16-Frame"><nobr><span class="math" id="MathJax-Span-409" style="width: 23.058em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.215em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.9em 1000.002em 4.539em -0.368em); top: -3.424em; left: 0.002em;"><span class="mrow" id="MathJax-Span-410"><span class="mi" id="MathJax-Span-411" style="font-family: MathJax_Math-italic;">λ</span><span class="mo" id="MathJax-Span-412" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-413"><span style="display: inline-block; position: relative; width: 1.993em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-414" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-415"><span class="mrow" id="MathJax-Span-416"><span class="mi" id="MathJax-Span-417" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-418" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-419" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-420" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-421" style="font-family: MathJax_Main; padding-left: 0.28em;">=</span><span class="mstyle" id="MathJax-Span-422" style="padding-left: 0.28em;"><span class="mrow" id="MathJax-Span-423"><span class="mfrac" id="MathJax-Span-424"><span style="display: inline-block; position: relative; width: 3.382em; height: 0px; margin-right: 0.141em; margin-left: 0.141em;"><span style="position: absolute; clip: rect(1.762em 1000.002em 2.734em -0.368em); top: -3.285em; left: 50%; margin-left: -0.229em;"><span class="mi" id="MathJax-Span-425" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; clip: rect(1.854em 1000.002em 3.104em -0.368em); top: -2.035em; left: 50%; margin-left: -1.618em;"><span class="mrow" id="MathJax-Span-426"><span class="mi" id="MathJax-Span-427" style="font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-428" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-429"><span style="display: inline-block; position: relative; width: 1.993em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-430" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-431"><span class="mrow" id="MathJax-Span-432"><span class="mi" id="MathJax-Span-433" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-434" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-435" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-436" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.734em;"></span></span><span style="position: absolute; clip: rect(0.882em 1000.002em 1.206em -0.414em); top: -1.294em; left: 0.002em;"><span style="border-left-width: 3.382em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.049em; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.067em;"></span></span></span></span></span></span><span class="mrow" id="MathJax-Span-437" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-438" style="vertical-align: 0.789em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.28em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.238em; left: 0.002em;">∣<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.1em; left: 0.002em;">∣<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-439" style="font-family: MathJax_Main;">{</span><span class="msup" id="MathJax-Span-440"><span style="display: inline-block; position: relative; width: 1.067em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-441" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.914em; left: 0.743em;"><span class="mo" id="MathJax-Span-442" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-443" style="font-family: MathJax_Main; padding-left: 0.28em;">:</span><span class="mi" id="MathJax-Span-444" style="font-family: MathJax_Math-italic; padding-left: 0.28em;">c</span><span class="mo" id="MathJax-Span-445" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-446"><span style="display: inline-block; position: relative; width: 1.993em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-447" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-448"><span class="mrow" id="MathJax-Span-449"><span class="mi" id="MathJax-Span-450" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-451" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-452" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-453" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-454" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.067em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-455" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.914em; left: 0.743em;"><span class="mo" id="MathJax-Span-456" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-457" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-458" style="font-family: MathJax_Main; padding-left: 0.28em;">&gt;</span><span class="mn" id="MathJax-Span-459" style="font-family: MathJax_Main; padding-left: 0.28em;">0</span><span class="mo" id="MathJax-Span-460" style="font-family: MathJax_Main;">}</span><span class="mo" id="MathJax-Span-461" style="vertical-align: 0.789em;"><span style="display: inline-block; position: relative; width: 0.28em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.238em; left: 0.002em;">∣<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.1em; left: 0.002em;">∣<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-462" style="font-family: MathJax_Main; padding-left: 0.188em;">.</span></span><span style="display: inline-block; width: 0px; height: 3.428em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.947em; vertical-align: -1.219em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-16">\lambda(w_{i-1}) = \dfrac{\delta}{c(w_{i-1})} \left| \{w' : c(w_{i-1}, w') > 0\} \right|.</script>

<p>Note that the denominator of the first term can be simplified to a unigram count. Here is the final interpolated Kneser-Ney smoothed bigram model, in all its glory:</p>

<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-17-Frame"><nobr><span class="math" id="MathJax-Span-463" style="width: 37.826em; display: inline-block;"><span style="display: inline-block; position: relative; width: 31.53em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.16em 1000.002em 3.938em -0.368em); top: -2.729em; left: 0.002em;"><span class="mrow" id="MathJax-Span-464"><span class="msubsup" id="MathJax-Span-465"><span style="display: inline-block; position: relative; width: 1.808em; height: 0px;"><span style="position: absolute; clip: rect(1.762em 1000.002em 2.734em -0.368em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-466" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.65em;"><span class="texatom" id="MathJax-Span-467"><span class="mrow" id="MathJax-Span-468"><span class="texatom" id="MathJax-Span-469"><span class="mrow" id="MathJax-Span-470"><span class="mi" id="MathJax-Span-471" style="font-size: 70.7%; font-family: MathJax_Main-italic;">K</span><span class="mi" id="MathJax-Span-472" style="font-size: 70.7%; font-family: MathJax_Main-italic;">N</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-473" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-474"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-475" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.743em;"><span class="mi" id="MathJax-Span-476" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-477" style="font-family: MathJax_Main; padding-left: 0.28em;">∣</span><span class="msubsup" id="MathJax-Span-478" style="padding-left: 0.28em;"><span style="display: inline-block; position: relative; width: 1.993em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-479" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-480"><span class="mrow" id="MathJax-Span-481"><span class="mi" id="MathJax-Span-482" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-483" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-484" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-485" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-486" style="font-family: MathJax_Main; padding-left: 0.28em;">=</span><span class="mstyle" id="MathJax-Span-487" style="padding-left: 0.28em;"><span class="mrow" id="MathJax-Span-488"><span class="mfrac" id="MathJax-Span-489"><span style="display: inline-block; position: relative; width: 9.771em; height: 0px; margin-right: 0.141em; margin-left: 0.141em;"><span style="position: absolute; clip: rect(1.854em 1000.002em 3.104em -0.368em); top: -3.424em; left: 50%; margin-left: -4.813em;"><span class="mrow" id="MathJax-Span-490"><span class="mo" id="MathJax-Span-491" style="font-family: MathJax_Main;">max</span><span class="mo" id="MathJax-Span-492" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-493" style="font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-494" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-495"><span style="display: inline-block; position: relative; width: 1.993em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-496" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-497"><span class="mrow" id="MathJax-Span-498"><span class="mi" id="MathJax-Span-499" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-500" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-501" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-502"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-503" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.743em;"><span class="mi" id="MathJax-Span-504" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-505" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-506" style="font-family: MathJax_Main; padding-left: 0.234em;">−</span><span class="mi" id="MathJax-Span-507" style="font-family: MathJax_Math-italic; padding-left: 0.234em;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-508" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-509" style="font-family: MathJax_Main; padding-left: 0.188em;">0</span><span class="mo" id="MathJax-Span-510" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.734em;"></span></span><span style="position: absolute; clip: rect(1.854em 1000.002em 3.104em -0.368em); top: -2.035em; left: 50%; margin-left: -1.618em;"><span class="mrow" id="MathJax-Span-511"><span class="mi" id="MathJax-Span-512" style="font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-513" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-514"><span style="display: inline-block; position: relative; width: 1.993em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-515" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-516"><span class="mrow" id="MathJax-Span-517"><span class="mi" id="MathJax-Span-518" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-519" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-520" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-521" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.734em;"></span></span><span style="position: absolute; clip: rect(0.882em 1000.002em 1.206em -0.414em); top: -1.294em; left: 0.002em;"><span style="border-left-width: 9.771em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.049em; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.067em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-522" style="font-family: MathJax_Main; padding-left: 0.234em;">+</span><span class="mi" id="MathJax-Span-523" style="font-family: MathJax_Math-italic; padding-left: 0.234em;">λ</span><span class="mstyle" id="MathJax-Span-524" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-525"><span class="mfrac" id="MathJax-Span-526"><span style="display: inline-block; position: relative; width: 11.299em; height: 0px; margin-right: 0.141em; margin-left: 0.141em;"><span style="position: absolute; clip: rect(1.854em 1000.002em 3.104em -0.275em); top: -3.424em; left: 50%; margin-left: -5.507em;"><span class="mrow" id="MathJax-Span-527"><span class="mo" id="MathJax-Span-528" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Main;">|</span></span><span class="mo" id="MathJax-Span-529" style="font-family: MathJax_Main;">{</span><span class="msubsup" id="MathJax-Span-530"><span style="display: inline-block; position: relative; width: 1.993em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-531" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-532"><span class="mrow" id="MathJax-Span-533"><span class="mi" id="MathJax-Span-534" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-535" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-536" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-537" style="font-family: MathJax_Main; padding-left: 0.28em;">:</span><span class="mi" id="MathJax-Span-538" style="font-family: MathJax_Math-italic; padding-left: 0.28em;">c</span><span class="mo" id="MathJax-Span-539" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-540"><span style="display: inline-block; position: relative; width: 1.993em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-541" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-542"><span class="mrow" id="MathJax-Span-543"><span class="mi" id="MathJax-Span-544" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-545" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-546" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-547" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-548" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-549" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.743em;"><span class="mi" id="MathJax-Span-550" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-551" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-552" style="font-family: MathJax_Main; padding-left: 0.28em;">&gt;</span><span class="mn" id="MathJax-Span-553" style="font-family: MathJax_Main; padding-left: 0.28em;">0</span><span class="mo" id="MathJax-Span-554" style="font-family: MathJax_Main;">}</span><span class="mo" id="MathJax-Span-555" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 2.734em;"></span></span><span style="position: absolute; clip: rect(2.502em 1000.002em 3.845em -0.414em); top: -2.683em; left: 50%; margin-left: -5.553em;"><span class="mrow" id="MathJax-Span-556"><span class="mo" id="MathJax-Span-557" style="vertical-align: 0.789em;"><span style="display: inline-block; position: relative; width: 0.28em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.238em; left: 0.002em;">∣<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.146em; left: 0.002em;">∣<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-558" style="font-family: MathJax_Main;">{</span><span class="msubsup" id="MathJax-Span-559"><span style="display: inline-block; position: relative; width: 2.039em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-560" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-561"><span class="mrow" id="MathJax-Span-562"><span class="mi" id="MathJax-Span-563" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-564" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-565" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-566" style="font-family: MathJax_Main; padding-left: 0.28em;">:</span><span class="mi" id="MathJax-Span-567" style="font-family: MathJax_Math-italic; padding-left: 0.28em;">c</span><span class="mo" id="MathJax-Span-568" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-569"><span style="display: inline-block; position: relative; width: 2.039em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-570" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.359em; left: 0.743em;"><span class="texatom" id="MathJax-Span-571"><span class="mrow" id="MathJax-Span-572"><span class="mi" id="MathJax-Span-573" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-574" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-575" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.502em;"></span></span></span></span><span class="mo" id="MathJax-Span-576" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-577" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.16em; height: 0px;"><span style="position: absolute; clip: rect(1.993em 1000.002em 2.734em -0.414em); top: -2.59em; left: 0.002em;"><span class="mi" id="MathJax-Span-578" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 2.595em;"></span></span><span style="position: absolute; top: -2.313em; left: 0.743em;"><span class="mi" id="MathJax-Span-579" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 2.456em;"></span></span></span></span><span class="mo" id="MathJax-Span-580" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-581" style="font-family: MathJax_Main; padding-left: 0.28em;">&gt;</span><span class="mn" id="MathJax-Span-582" style="font-family: MathJax_Main; padding-left: 0.28em;">0</span><span class="mo" id="MathJax-Span-583" style="font-family: MathJax_Main;">}</span><span class="mo" id="MathJax-Span-584" style="vertical-align: 0.789em;"><span style="display: inline-block; position: relative; width: 0.28em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.238em; left: 0.002em;">∣<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.146em; left: 0.002em;">∣<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.428em;"></span></span><span style="position: absolute; clip: rect(0.882em 1000.002em 1.206em -0.414em); top: -1.294em; left: 0.002em;"><span style="border-left-width: 11.299em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.049em; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.067em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.734em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.114em; vertical-align: -1.331em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-17">P_{\mathit{KN}}(w_i \mid w_{i-1}) = \dfrac{\max(c(w_{i-1} w_i) - \delta, 0)}{c(w_{i-1})} + \lambda \dfrac{\left| \{ w_{i-1} : c(w_{i-1}, w_i) > 0 \} \right|}{\left| \{ w_{j-1} : c(w_{j-1},w_j) > 0\} \right|}</script>

<h2 id="further-reading">Further reading</h2>

<p>If you enjoyed this post, here is some further reading on Kneser-Ney and other
smoothing methods:</p>

<ul>
  <li>Bill MacCartney’s <a href="http://nlp.stanford.edu/~wcmac/papers/20050421-smoothing-tutorial.pdf">smoothing tutorial</a> (very accessible)</li>
  <li><a href="http://u.cs.biu.ac.il/~yogo/courses/mt2013/papers/chen-goodman-99.pdf">Chen and Goodman (1999)</a></li>
  <li>Section 4.9.1 in Jurafsky and Martin’s <a href="http://www.amazon.com/gp/product/0131873210/ref=as_li_qf_sp_asin_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=0131873210&linkCode=as2&tag=blog0cbb-20"><em>Speech and Language Processing</em></a></li>
</ul>

<script type="text/javascript" src="./Kneser-Ney smoothing explained - foldl_files/MathJax.js"></script>

<p><img src="./Kneser-Ney smoothing explained - foldl_files/ir" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;"></p>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>For the canonical definition of interpolated Kneser-Ney smoothing, see S. F. Chen and J. Goodman, <a href="http://u.cs.biu.ac.il/~yogo/courses/mt2013/papers/chen-goodman-99.pdf">“An empirical study of smoothing techniques for language modeling,”</a> Computer Speech and Language, vol. 13, no. 4, pp. 359–394, 1999. <a href="http://www.foldl.me/2014/kneser-ney-smoothing/#fnref:1" class="reversefootnote">↩</a></p>
    </li>
  </ol>
</div>

  </div>
</article>


<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
    <li><span>24 Sep 2014</span> » <a href="http://www.foldl.me/2014/glove-python/">A GloVe implementation in Python</a></li>
    
    <li><span>13 Sep 2014</span> » <a href="http://www.foldl.me/2014/spanish-summarizer-corenlp/">Summarizing Spanish with Stanford CoreNLP</a></li>
    
    <li><span>14 Aug 2014</span> » <a href="http://www.foldl.me/2014/metacademy/">On Metacademy and knowledge graphs</a></li>
    
  </ul>
</div>


<div id="disqus_thread"><iframe id="dsq-2" data-disqus-uid="2" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./Kneser-Ney smoothing explained - foldl_files/saved_resource.html" style="width: 100% !important; border: none !important; overflow: hidden !important; height: 611px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe><iframe id="dsq-indicator-north" data-disqus-uid="indicator-north" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" style="width: 608px !important; border: none !important; overflow: hidden !important; top: 0px !important; min-width: 608px !important; max-width: 608px !important; position: fixed !important; z-index: 2147483646 !important; height: 29px !important; min-height: 29px !important; max-height: 29px !important; display: none !important;"></iframe><iframe id="dsq-indicator-south" data-disqus-uid="indicator-south" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" style="width: 608px !important; border: none !important; overflow: hidden !important; bottom: 0px !important; min-width: 608px !important; max-width: 608px !important; position: fixed !important; z-index: 2147483646 !important; height: 29px !important; min-height: 29px !important; max-height: 29px !important; display: none !important;"></iframe></div>
<script type="text/javascript">
  var disqusLoaded = false;
  window.onscroll = function() {
    if ( disqusLoaded ) return;

    disqusLoaded = true;
    window.onscroll = null;

    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'http://foldl.disqus.com/embed.js';
    document.body.appendChild(dsq);
  };
</script>
<noscript>Please enable JavaScript to view the &lt;a href="http://disqus.com/?ref_noscript"&gt;comments powered by Disqus.&lt;/a&gt;</noscript>


        <footer>
	        <div id="hcard-Jon-Gauthier" class="vcard">
            <a class="email fn n" href="mailto:jon@gauthiers.net">
              <span class="given-name">Jon</span>
              <span class="family-name">Gauthier</span>
            </a> — <span class="adr">
              <span class="locality">Stanford</span>, <span class="region">California</span>
            </span>
	        </div>
        </footer>
      </div>
    </section>
  </div>

  <script type="text/javascript" src="./Kneser-Ney smoothing explained - foldl_files/jquery-1.8.3.min.js"></script>
  <script type="text/javascript" src="./Kneser-Ney smoothing explained - foldl_files/jquery.qtip.min.js"></script>
  <script type="text/javascript" src="./Kneser-Ney smoothing explained - foldl_files/script.js"></script>
  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-33380670-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
  </script>


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Main-italic, sans-serif;"></div></div><div><div id="SL_button" class="ImTranslatorLogo" style="display: none; left: 428px; top: 1762px;"></div><div id="SL_shadow_translation_result2" style="display: none;"></div><div id="SL_shadow_translator" style="display: none;"><div id="SL_planshet"><div id="SL_TB"><div class="ImTranslatorLogo"></div><table cellspacing="1" border="0" id="SL_tables"><tbody><tr><td class="SL_td" align="left" width="20%"><div id="SL_lng_from">English&nbsp;»</div></td><td class="SL_td" align="left" width="20%"><div id="SL_to_"><div id="SL_tocurlng" style="margin-left:5px;">Spanish</div><div class="SL_arrow"></div><div id="SL_to_list" style="display=" none'=""><div class="SL_DDMENU"><div id="SL_af" class="SL_limenu">Afrikaans</div><div id="SL_sq" class="SL_limenu">Albanian</div><div id="SL_ar" class="SL_limenu">Arabic</div><div id="SL_hy" class="SL_limenu">Armenian</div><div id="SL_az" class="SL_limenu">Azerbaijani</div><div id="SL_eu" class="SL_limenu">Basque</div><div id="SL_bn" class="SL_limenu">Bengali</div><div id="SL_be" class="SL_limenu">Belarusian</div><div id="SL_bg" class="SL_limenu">Bulgarian</div><div id="SL_ca" class="SL_limenu">Catalan</div><div id="SL_zh_CN" class="SL_limenu">Chinese&nbsp;(Simp)</div><div id="SL_zh_TW" class="SL_limenu">Chinese&nbsp;(Trad)</div><div id="SL_hr" class="SL_limenu">Croatian</div><div id="SL_cs" class="SL_limenu">Czech</div><div id="SL_da" class="SL_limenu">Danish</div><div id="SL_nl" class="SL_limenu">Dutch</div><div id="SL_en" class="SL_limenu">English</div><div id="SL_eo" class="SL_limenu">Esperanto</div><div id="SL_et" class="SL_limenu">Estonian</div><div id="SL_tl" class="SL_limenu">Filipino</div><div id="SL_fi" class="SL_limenu">Finnish</div><div id="SL_fr" class="SL_limenu">French</div><div id="SL_gl" class="SL_limenu">Galician</div><div id="SL_ka" class="SL_limenu">Georgian</div><div id="SL_de" class="SL_limenu">German</div><div id="SL_el" class="SL_limenu">Greek</div><div id="SL_gu" class="SL_limenu">Gujarati</div><div id="SL_ht" class="SL_limenu">Haitian&nbsp;Creole</div><div id="SL_iw" class="SL_limenu">Hebrew</div><div id="SL_hi" class="SL_limenu">Hindi</div><div id="SL_hu" class="SL_limenu">Hungarian</div><div id="SL_is" class="SL_limenu">Icelandic</div><div id="SL_id" class="SL_limenu">Indonesian</div><div id="SL_ga" class="SL_limenu">Irish</div><div id="SL_it" class="SL_limenu">Italian</div><div id="SL_ja" class="SL_limenu">Japanese</div><div id="SL_kn" class="SL_limenu">Kannada</div><div id="SL_ko" class="SL_limenu">Korean</div><div id="SL_lo" class="SL_limenu">Lao</div><div id="SL_la" class="SL_limenu">Latin</div><div id="SL_lv" class="SL_limenu">Latvian</div><div id="SL_lt" class="SL_limenu">Lithuanian</div><div id="SL_mk" class="SL_limenu">Macedonian</div><div id="SL_ms" class="SL_limenu">Malay</div><div id="SL_mt" class="SL_limenu">Maltese</div><div id="SL_no" class="SL_limenu">Norwegian</div><div id="SL_fa" class="SL_limenu">Persian</div><div id="SL_pl" class="SL_limenu">Polish</div><div id="SL_pt" class="SL_limenu">Portuguese</div><div id="SL_ro" class="SL_limenu">Romanian</div><div id="SL_ru" class="SL_limenu">Russian</div><div id="SL_sr" class="SL_limenu">Serbian</div><div id="SL_sk" class="SL_limenu">Slovak</div><div id="SL_sl" class="SL_limenu">Slovenian</div><div id="SL_es" class="SL_limenu">Spanish</div><div id="SL_sw" class="SL_limenu">Swahili</div><div id="SL_sv" class="SL_limenu">Swedish</div><div id="SL_ta" class="SL_limenu">Tamil</div><div id="SL_te" class="SL_limenu">Telugu</div><div id="SL_th" class="SL_limenu">Thai</div><div id="SL_tr" class="SL_limenu">Turkish</div><div id="SL_uk" class="SL_limenu">Ukrainian</div><div id="SL_ur" class="SL_limenu">Urdu</div><div id="SL_vi" class="SL_limenu">Vietnamese</div><div id="SL_cy" class="SL_limenu">Welsh</div><div id="SL_yi" class="SL_limenu">Yiddish</div></div></div></div><select id="SL_lng_to"><option value="af">Afrikaans</option><option value="sq">Albanian</option><option value="ar">Arabic</option><option value="hy">Armenian</option><option value="az">Azerbaijani</option><option value="eu">Basque</option><option value="bn">Bengali</option><option value="be">Belarusian</option><option value="bg">Bulgarian</option><option value="ca">Catalan</option><option value="zh-CN">Chinese&nbsp;(Simp)</option><option value="zh-TW">Chinese&nbsp;(Trad)</option><option value="hr">Croatian</option><option value="cs">Czech</option><option value="da">Danish</option><option value="nl">Dutch</option><option value="en">English</option><option value="eo">Esperanto</option><option value="et">Estonian</option><option value="tl">Filipino</option><option value="fi">Finnish</option><option value="fr">French</option><option value="gl">Galician</option><option value="ka">Georgian</option><option value="de">German</option><option value="el">Greek</option><option value="gu">Gujarati</option><option value="ht">Haitian&nbsp;Creole</option><option value="iw">Hebrew</option><option value="hi">Hindi</option><option value="hu">Hungarian</option><option value="is">Icelandic</option><option value="id">Indonesian</option><option value="ga">Irish</option><option value="it">Italian</option><option value="ja">Japanese</option><option value="kn">Kannada</option><option value="ko">Korean</option><option value="lo">Lao</option><option value="la">Latin</option><option value="lv">Latvian</option><option value="lt">Lithuanian</option><option value="mk">Macedonian</option><option value="ms">Malay</option><option value="mt">Maltese</option><option value="no">Norwegian</option><option value="fa">Persian</option><option value="pl">Polish</option><option value="pt">Portuguese</option><option value="ro">Romanian</option><option value="ru">Russian</option><option value="sr">Serbian</option><option value="sk">Slovak</option><option value="sl">Slovenian</option><option selected="" value="es">Spanish</option><option value="sw">Swahili</option><option value="sv">Swedish</option><option value="ta">Tamil</option><option value="te">Telugu</option><option value="th">Thai</option><option value="tr">Turkish</option><option value="uk">Ukrainian</option><option value="ur">Urdu</option><option value="vi">Vietnamese</option><option value="cy">Welsh</option><option value="yi">Yiddish</option></select></td><td class="SL_td" width="13%" align="center">&nbsp;</td><td class="SL_td" width="8%" align="center"><div id="SL_TTS_voice" title=""></div></td><td class="SL_td" width="8%" align="center"><div class="SL_copy_hand" id="SL_copy" title="Select text"></div></td><td class="SL_td" width="8%" align="center"><div class="SL_font_off" id="SL_bbl_font" title="Font size"></div></td><td class="SL_td" width="5%"></td><td class="SL_td" width="8%" align="right"><div class="SL_pin_off" id="SL_pin" title="Pin pup-up bubble"></div></td></tr></tbody></table></div></div><div id="SL_shadow_translation_result"></div><div id="SL_bbl_donate" title="Make a small contribution"></div><div id="SL_Balloon_options"><a href="chrome-extension://pcfaommkmdjacdkbaoohklbccfmbnnod/options-bbl.html" target="_blank" class="SL_options" title="Show options">Options</a></div></div></div><script type="text/javascript" async="" src="./Kneser-Ney smoothing explained - foldl_files/embed.js"></script></body></html>