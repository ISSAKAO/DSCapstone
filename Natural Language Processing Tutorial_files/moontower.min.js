/*
page-predict - v0.0.1 - 2014-04-25
Predict the next page.
Lovingly coded by Yhat  - http://yhathq.com 
*/
!function(){function getCookie(cname){for(var name=cname+"=",ca=documentAlias.cookie.split(";"),i=0;i<ca.length;i++){var c=ca[i].trim();if(0===c.indexOf(name))return c.substring(name.length,c.length)}return null}function setCookie(cname,cvalue,exdays){var d=new Date;d.setTime(d.getTime()+24*exdays*60*60*1e3);var expires="expires="+d.toGMTString();documentAlias.cookie=cname+"="+cvalue+"; "+expires}function utf8_encode(argString){return urldecode(encodeWrapper(argString))}function sha1(str){var blockstart,i,j,A,B,C,D,E,temp,str_len,rotate_left=function(n,s){return n<<s|n>>>32-s},cvt_hex=function(val){var i,v,strout="";for(i=7;i>=0;i--)v=val>>>4*i&15,strout+=v.toString(16);return strout},W=[],H0=1732584193,H1=4023233417,H2=2562383102,H3=271733878,H4=3285377520,word_array=[];for(str=utf8_encode(str),str_len=str.length,i=0;str_len-3>i;i+=4)j=str.charCodeAt(i)<<24|str.charCodeAt(i+1)<<16|str.charCodeAt(i+2)<<8|str.charCodeAt(i+3),word_array.push(j);switch(3&str_len){case 0:i=2147483648;break;case 1:i=str.charCodeAt(str_len-1)<<24|8388608;break;case 2:i=str.charCodeAt(str_len-2)<<24|str.charCodeAt(str_len-1)<<16|32768;break;case 3:i=str.charCodeAt(str_len-3)<<24|str.charCodeAt(str_len-2)<<16|str.charCodeAt(str_len-1)<<8|128}for(word_array.push(i);14!==(15&word_array.length);)word_array.push(0);for(word_array.push(str_len>>>29),word_array.push(str_len<<3&4294967295),blockstart=0;blockstart<word_array.length;blockstart+=16){for(i=0;16>i;i++)W[i]=word_array[blockstart+i];for(i=16;79>=i;i++)W[i]=rotate_left(W[i-3]^W[i-8]^W[i-14]^W[i-16],1);for(A=H0,B=H1,C=H2,D=H3,E=H4,i=0;19>=i;i++)temp=rotate_left(A,5)+(B&C|~B&D)+E+W[i]+1518500249&4294967295,E=D,D=C,C=rotate_left(B,30),B=A,A=temp;for(i=20;39>=i;i++)temp=rotate_left(A,5)+(B^C^D)+E+W[i]+1859775393&4294967295,E=D,D=C,C=rotate_left(B,30),B=A,A=temp;for(i=40;59>=i;i++)temp=rotate_left(A,5)+(B&C|B&D|C&D)+E+W[i]+2400959708&4294967295,E=D,D=C,C=rotate_left(B,30),B=A,A=temp;for(i=60;79>=i;i++)temp=rotate_left(A,5)+(B^C^D)+E+W[i]+3395469782&4294967295,E=D,D=C,C=rotate_left(B,30),B=A,A=temp;H0=H0+A&4294967295,H1=H1+B&4294967295,H2=H2+C&4294967295,H3=H3+D&4294967295,H4=H4+E&4294967295}return temp=cvt_hex(H0)+cvt_hex(H1)+cvt_hex(H2)+cvt_hex(H3)+cvt_hex(H4),temp.toLowerCase()}function guid(){var now=new Date;return sha1((navigatorAlias.userAgent||"")+(navigatorAlias.platform||"")+now.getTime()+_mt.apikey+Math.random()).slice(0,16)}var documentAlias=document,navigatorAlias=navigator,windowAlias=window,encodeWrapper=windowAlias.encodeURIComponent,urldecode=(windowAlias.decodeURIComponent,unescape);uid=getCookie("moontower")||guid(),setCookie("moontower",uid,1/24);var request=new XMLHttpRequest,uri="https://moontower.yhathq.com/predict?page="+window.location.pathname+"&apikey="+_mt.apikey+"&userid="+uid;_mt.image_map&&(uri+="&image_map=1"),request.open("GET",uri,!0),request.onload=function(){if(request.status>=200&&request.status<400){var data=JSON.parse(request.responseText);if(data.result){if(_mt.image_map&&data.pages){var pages=data.pages,alreadyLoaded=[];data.result.forEach(function(page){pages[page.url]&&pages[page.url].forEach(function(img_src){if(alreadyLoaded.indexOf(img_src)<0){var img=new Image;img.src=img_src,alreadyLoaded.push(img_src)}})})}_mt.init&&_mt.init(data.result)}}},request.onerror=function(){},request.setRequestHeader("Content-Type","application/json; charset=UTF-8"),request.send()}();