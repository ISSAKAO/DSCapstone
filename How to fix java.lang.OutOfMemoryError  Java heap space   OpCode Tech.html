<!DOCTYPE html>
<!-- saved from url=(0081)http://opcodesolutions.com/tech/solve-java-lang-outofmemoryerror-java-heap-space/ -->
<html lang="en-US"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<title>How to fix java.lang.OutOfMemoryError: Java heap space | OpCode Tech</title>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="http://opcodesolutions.com/tech/xmlrpc.php">
<!--[if lt IE 9]>
<script src="http://opcodesolutions.com/tech/wp-content/themes/twentytwelve/js/html5.js" type="text/javascript"></script>
<![endif]-->
<link rel="alternate" type="application/rss+xml" title="OpCode Tech » Feed" href="http://opcodesolutions.com/tech/feed/">
<link rel="alternate" type="application/rss+xml" title="OpCode Tech » Comments Feed" href="http://opcodesolutions.com/tech/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="OpCode Tech » How to fix java.lang.OutOfMemoryError: Java heap space Comments Feed" href="http://opcodesolutions.com/tech/solve-java-lang-outofmemoryerror-java-heap-space/feed/">
<link rel="stylesheet" id="crayon-css" href="./How to fix java.lang.OutOfMemoryError  Java heap space   OpCode Tech_files/crayon.min.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-classic-css" href="./How to fix java.lang.OutOfMemoryError  Java heap space   OpCode Tech_files/classic.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="./How to fix java.lang.OutOfMemoryError  Java heap space   OpCode Tech_files/monaco.css" type="text/css" media="all">
<link rel="stylesheet" id="twentytwelve-fonts-css" href="./How to fix java.lang.OutOfMemoryError  Java heap space   OpCode Tech_files/css" type="text/css" media="all">
<link rel="stylesheet" id="twentytwelve-style-css" href="./How to fix java.lang.OutOfMemoryError  Java heap space   OpCode Tech_files/style.css" type="text/css" media="all">
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentytwelve-ie-css'  href='http://opcodesolutions.com/tech/wp-content/themes/twentytwelve/css/ie.css?ver=20121010' type='text/css' media='all' />
<![endif]-->
<script async="" src="./How to fix java.lang.OutOfMemoryError  Java heap space   OpCode Tech_files/analytics.js"></script><script type="text/javascript" src="./How to fix java.lang.OutOfMemoryError  Java heap space   OpCode Tech_files/jquery.js"></script>
<script type="text/javascript" src="./How to fix java.lang.OutOfMemoryError  Java heap space   OpCode Tech_files/jquery-migrate.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"2.6.8","is_admin":"0","ajaxurl":"http:\/\/opcodesolutions.com\/tech\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="./How to fix java.lang.OutOfMemoryError  Java heap space   OpCode Tech_files/crayon.min.js"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://opcodesolutions.com/tech/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://opcodesolutions.com/tech/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="How to fix java.lang.OutOfMemoryError: PermGen space" href="http://opcodesolutions.com/tech/java-lang-outofmemoryerror-permgen-space/">
<link rel="next" title="Programmatically Configure Hibernate (JPA) with DBCP" href="http://opcodesolutions.com/tech/programmatically-configure-hibernate-jpa-with-dbcp/">
<meta name="generator" content="WordPress 4.0">
<link rel="canonical" href="./How to fix java.lang.OutOfMemoryError  Java heap space   OpCode Tech_files/How to fix java.lang.OutOfMemoryError  Java heap space   OpCode Tech.html">
<link rel="shortlink" href="http://opcodesolutions.com/tech/?p=12">
	<style type="text/css" id="twentytwelve-header-css">
			.site-header h1 a,
		.site-header h2 {
			color: #8b0000;
		}
		</style>
	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-574976-2', 'auto');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');

</script>
<style class="winnerfm-style">.freefl-overlay{
    cursor: pointer;
    background-color: #3c3c3c;
    text-align: left;
    margin: 0px;
    padding: 0px;
    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3FpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo5Mjc5OWJhMS1jNzIwLTE5NGEtYTc1Ny1jNWIxODYyNTE2ZTciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTEyQjEzQkZENTAyMTFFM0I2ODg5NjQ1MjUxOERCMjIiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTEyQjEzQkVENTAyMTFFM0I2ODg5NjQ1MjUxOERCMjIiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjkyNzk5YmExLWM3MjAtMTk0YS1hNzU3LWM1YjE4NjI1MTZlNyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5Mjc5OWJhMS1jNzIwLTE5NGEtYTc1Ny1jNWIxODYyNTE2ZTciLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5GhQdBAAAFFklEQVR42uyc3VKzQAyGt5FWbXX0wBnv/7r0Bjzx31Zb234vBCNdYMlXgULJHnSg0JB9Jhv27+3o/v5+u926YDk7Ozs5OQnfAyOLxaIuU5+fn5vNJnzb6elpFEW1mJpMJuPx2FUVMlJKUjBFRkpJar1ek5FSkoqboZFSkiqFZaTypIphGalCUgWwjFQZKR+WkQqQ2oFlpMKkfmEZqUpSKSwjpSEVwzJSSlIxLCOlJAVT0RGT0pjSkwJ0MlJKUqGxoZHKN2QyUvqUR0ZK/3KIhkYKpr6+vvYg5UeWkQp3OH6twxv4ZKQCXbOoaVK3t7fZq+/v7x8fH3uQms1mFxcX2asPDw9iHHd+f3+DRXOkUlhNxxROxUt+yt4xBSKenzjFPXAMlcTBarVqiFQMq4XWBy8fHx9raX0ITC98cA/yLAzCw9Fo1BypGFb7eQpuERG8h038iquBY1R1kxQ2xTfjs6xx8dWm89QOrBZIgQJXDA7hTkQBnGNY+MQPs49A3V5fX/HN5eWlNL2np6fU3Z+QpKTIl4VVrZcU/IxaiClU5vr6WtqREFwul8wOj+C8BqfhOo6n02nqX1LOz8/5V5Ljl0nhkGQPOcc3RwqmohZaHx6DvCuBILXlusFdPuXczK7jubj68vKCkBTQ7DSHlTwRB2wHn/JlE6QKevBN5CmuSfgGbpJZoAg9dBe8VwHuyb8NOcQajani4U4TpDRlnBQPn9exkohrLaN7Q8io6XefEhZymUcBp5LgcJwH1zIpt/cia41DEE5VXE88HU1PmiF3GmZJ8VJe+6T8yDrIuI8TPDoKeANy5uJQws9vbm7Yn8rHtUDK7bHIWvsIGZ/z+ZyHLPwGxFV0tXDMvdZVUg5OKg72u7u7vs8ltLbMEzlbZFVPn9oi639MNNsiq5ZUxbqhkcqSiidLjJSSlDvWRdYmSJWODY1UoSkyUnpTZKT0pshI6U2RkdKbIiOlN0VGSm+KjJTeFBkp176S9ehJtbTIepBJwdpJ1aNkHQgp93cl63BIuT8qWQdFyv1FyTo0Uq4Li6x9IeX2U7IOk9TO5N+QtyEroZOR0ocnGSl9QyYjpU95ZKRcjYusRsopF1mNlFMushopV7nIOkmKS3bj8TdZSRFvP3t7e+s1Kd6hKvtURX4VIOUCW7vzkiLZ1z+dTtdJ6W9MuSL5VZiUK1SyrlYr3JSXFLFeCV2Nq6srGCpUFfWl9SGmPPlVJakUFqrNHQhggiHRfpT57RKNw5HlKRCAJyAQdxF+hEFZ+VUMC9dktzqOWe/hMpIitEe2znol2Xrdd1Iiv3KJugotBuHGu6QL5VfgmOqpWFuDa3lJkSQ/0St5kqKexlRWfoU3WNpHJyqTX8WwWPr3/PyMrzxJkQiIJCPmJUX9bX04XSwW3m15+RVOOYx+EzwCyvMe1r0En5cU9TpPwc9sd6Fw2Ac/QUpeZZErkRR5k4It56n2t/eVwfLfhp6kyEMzqI2Q+VYpniDSye1Kijwd15BJyauM1bTxgScpkq7DwEmxG3Cbu13pIqtIinB5npRwMz4aUmhPgZgCE/QV4BVIifwqFTrlM/qQW58UZKdsjzIaICmlKY9UASwjFTBFRkpvioyU3hQZKb0pMlJ6U2Sk9KbISLn+LrJ2llTnFlm7TMp1apG146Rc4O+CjVR+CElGSj/Yjg5OqjtbRiunJchI6SdwyEjpp7rISOknBclIKUmlCX6blE6ROuymtbLyT4ABAI0sAxAZwQU9AAAAAElFTkSuQmCC);
    background-position: 0 0;
    background-repeat: repeat;
    z-index: 999999;
    position: relative;
}
</style></head>

<body class="single single-post postid-12 single-format-standard custom-background custom-font-enabled single-author">
<div id="page" class="hfeed site">
	<header id="masthead" class="site-header" role="banner">
		<hgroup>
			<h1 class="site-title"><a href="http://opcodesolutions.com/tech/" title="OpCode Tech" rel="home">OpCode Tech</a></h1>
			<h2 class="site-description">Optimize Your Processes</h2>
		</hgroup>

		<nav id="site-navigation" class="main-navigation" role="navigation">
			<button class="menu-toggle">Menu</button>
			<a class="assistive-text" href="http://opcodesolutions.com/tech/solve-java-lang-outofmemoryerror-java-heap-space/#content" title="Skip to content">Skip to content</a>
			<div class="menu-default-container"><ul id="menu-default" class="nav-menu"><li id="menu-item-19" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19"><a href="http://opcodesolutions.com/tech">Home</a></li>
<li id="menu-item-18" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-18"><a href="http://opcodesolutions.com/tech/category/news/">News</a></li>
<li id="menu-item-17" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-17"><a href="http://opcodesolutions.com/tech/category/development/">Development</a></li>
</ul></div>		</nav><!-- #site-navigation -->

			</header><!-- #masthead -->

	<div id="main" class="wrapper">
	<div id="primary" class="site-content">
		<div id="content" role="main">

			
				
	<article id="post-12" class="post-12 post type-post status-publish format-standard hentry category-development category-dump category-heap category-java category-jhat category-jmap category-jps category-leak category-memory category-outofmemoryerror category-visualvm">
				<header class="entry-header">
			
						<h1 class="entry-title">How to fix java.lang.OutOfMemoryError: Java heap space</h1>
										<div class="comments-link">
					<a href="http://opcodesolutions.com/tech/solve-java-lang-outofmemoryerror-java-heap-space/#respond" title="Comment on How to fix java.lang.OutOfMemoryError: Java heap space"><span class="leave-reply">Leave a reply</span></a>				</div><!-- .comments-link -->
					</header><!-- .entry-header -->

				<div class="entry-content">
			<p>If you get an <strong>OutOfMemoryError</strong> with the message “<strong>Java heap space</strong>” (not to be confused with message “<strong><a title="java.lang.OutOfMemoryError: PermGen space" href="http://opcodesolutions.com/tech/java-lang-outofmemoryerror-permgen-space/">PermGen space</a></strong>“), it simply means the JVM ran out of memory. When it occurs, you basically have 2 options:</p>
<h2>Solution 1. Allow the JVM to use more memory</h2>
<p>With the <strong>-Xmx</strong> JVM argument, you can set the heap size. For instance, you can allow the JVM to use 2 GB (2048 MB) of memory with the following command:</p><!-- Crayon Syntax Highlighter v2.6.8 -->

		<div id="crayon-5467dbd54589a439209955" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Configuring java heap size</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button crayon-pressed" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -18px; display: none;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 1; opacity: 1; overflow: hidden; height: 45px;">
$ java -Xmx2048m ...
</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 0; overflow: hidden; opacity: 0;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5467dbd54589a439209955-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5467dbd54589a439209955-2">2</div><div class="crayon-num" data-line="crayon-5467dbd54589a439209955-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5467dbd54589a439209955-1">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5467dbd54589a439209955-2"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-v">java</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Xmx2048m</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5467dbd54589a439209955-3">&nbsp;</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<h2>Solution 2. Improve or fix the application to reduce memory usage</h2>
<p>In many cases, like in the case of a memory leak, that second option is the only good solution. A memory leak happens when the application creates more and more objects and never releases them. The garbage collector cannot collect those objects and the application will eventually run out of memory. At this point, the JVM will throw an OOM (OutOfMemoryError).</p>
<p>A memory leak can be very latent. For instance, the application might behave flawlessly during development and QA. However, it suddenly throws a OOM after several days in production at customer site. To solve that issue, you first need to find the root cause of it. The root cause can be very hard to find in development if the problem cannot be reproduced. Follow those steps to find the root cause of the OOM:</p>
<h3>Step 1. Generate a heap dump on OutOfMemoryError</h3>
<p>Start the application with the VM argument <strong>-XX:+HeapDumpOnOutOfMemoryError</strong>. This will tell the JVM to produce a heap dump when a OOM occurs:</p><!-- Crayon Syntax Highlighter v2.6.8 -->

		<div id="crayon-5467dbd5458a3765633897" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Trigger heap dump on OOM</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">
$ java -XX:+HeapDumpOnOutOfMemoryError ...
</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5467dbd5458a3765633897-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5467dbd5458a3765633897-2">2</div><div class="crayon-num" data-line="crayon-5467dbd5458a3765633897-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5467dbd5458a3765633897-1">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5467dbd5458a3765633897-2"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-v">java</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">XX</span><span class="crayon-o">:</span><span class="crayon-o">+</span><span class="crayon-i">HeapDumpOnOutOfMemoryError</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5467dbd5458a3765633897-3">&nbsp;</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<h3>Step 2. Reproduce the problem</h3>
<p>Well, if you cannot reproduce the problem in dev, you may have to use the production environment. When you reproduce the problem and the application throws an OOM, it will generate a heap dump file.</p>
<h3>Step 3. Investigate the issue using the heap dump file</h3>
<p>Use <a title="VisualVM" href="http://visualvm.java.net/">VisualVM</a> to read the heap dump file and diagnose the issue. VisualVM is a program located in <strong>JDK_HOME/bin/jvisualvm</strong>. The heap dump file has all information about the memory usage of the application. It allows you to navigate the heap and see which objects use the most memory and what references prevent the garbage collector from reclaiming the memory. Here is a screenshot of <a title="VisualVM" href="http://visualvm.java.net/">VisualVM</a> with a heap dump loaded:</p>
<p><a href="./How to fix java.lang.OutOfMemoryError  Java heap space   OpCode Tech_files/2014-11-04-143434_714x503_scrot.png"><img class="alignnone size-full wp-image-37" src="./How to fix java.lang.OutOfMemoryError  Java heap space   OpCode Tech_files/2014-11-04-143434_714x503_scrot.png" alt="Heap Dump in VisualVM" width="714" height="503"></a></p>
<p>This will give you very strong hints and you will (hopefully) be able to find the root cause of the problem. The problem could be a cache that grows indefinitely, a list that keeps collecting business-specific data in memory, a huge request that tries to load almost all data from database in memory, etc.</p>
<p>Once you know the root cause of the problem, you can elaborate solutions to fix it. In case of a cache that grows indefinitely, a good solution could be to set a reasonable limit to that cache. In case of a query that tries to load almost all data from database in memory, you may have to change the way you manipulate data; you could even have to change the behavior of some functionalities of the application.</p>
<h2>Manually triggering heap dump</h2>
<p>If you do not want to wait for an OOM or if you just want to see what is in memory now, you can manually generate heap dump. Here 2 options to manually trigger a heap dump.</p>
<h3>Option 1. Use <a title="VisualVM" href="http://visualvm.java.net/">VisualVM</a></h3>
<p>Open VisualVM (JDK_HOME/bin/jvisualvm), right-click on the process on the left pane and select Heap Dump. That’s it.</p>
<h3>Option 2. Use command line tools</h3>
<p>If you do not have a graphical environment and can’t use vnc (<a title="VisualVM" href="http://visualvm.java.net/">VisualVM</a> needs a graphical environment), use <a title="Java Process Status" href="http://docs.oracle.com/javase/7/docs/technotes/tools/share/jps.html">jps</a> and <a title="Java Memory Map" href="http://docs.oracle.com/javase/7/docs/technotes/tools/share/jmap.html">jmap</a> to generate the heap dump file. Those programs are also located in <strong>JDK_HOME/bin/</strong>.</p><!-- Crayon Syntax Highlighter v2.6.8 -->

		<div id="crayon-5467dbd5458a8177632833" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Use jps and jmap to trigger heap dump</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: auto;">
$ jps
6162 Jps
4729 org.eclipse.equinox.launcher_1.3.0.v20130327-1440.jar
6057 Bootstrap

$ jmap -dump:live,format=b,file=heap.bin 6057
Dumping heap to /home/user/heap.bin ...
Heap dump file created
</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: auto;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5467dbd5458a8177632833-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5467dbd5458a8177632833-2">2</div><div class="crayon-num" data-line="crayon-5467dbd5458a8177632833-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5467dbd5458a8177632833-4">4</div><div class="crayon-num" data-line="crayon-5467dbd5458a8177632833-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5467dbd5458a8177632833-6">6</div><div class="crayon-num" data-line="crayon-5467dbd5458a8177632833-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5467dbd5458a8177632833-8">8</div><div class="crayon-num" data-line="crayon-5467dbd5458a8177632833-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5467dbd5458a8177632833-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5467dbd5458a8177632833-1">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5467dbd5458a8177632833-2"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-i">jps</span></div><div class="crayon-line" id="crayon-5467dbd5458a8177632833-3"><span class="crayon-cn">6162</span><span class="crayon-h"> </span><span class="crayon-i">Jps</span></div><div class="crayon-line crayon-striped-line" id="crayon-5467dbd5458a8177632833-4"><span class="crayon-cn">4729</span><span class="crayon-h"> </span><span class="crayon-v">org</span><span class="crayon-e">.eclipse</span><span class="crayon-e">.equinox</span><span class="crayon-e">.launcher_1</span><span class="crayon-sy">.</span><span class="crayon-cn">3.0.v20130327</span><span class="crayon-o">-</span><span class="crayon-cn">1440.jar</span></div><div class="crayon-line" id="crayon-5467dbd5458a8177632833-5"><span class="crayon-cn">6057</span><span class="crayon-h"> </span><span class="crayon-i">Bootstrap</span></div><div class="crayon-line crayon-striped-line" id="crayon-5467dbd5458a8177632833-6">&nbsp;</div><div class="crayon-line" id="crayon-5467dbd5458a8177632833-7"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-v">jmap</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">dump</span><span class="crayon-o">:</span><span class="crayon-v">live</span><span class="crayon-sy">,</span><span class="crayon-v">format</span><span class="crayon-o">=</span><span class="crayon-v">b</span><span class="crayon-sy">,</span><span class="crayon-r">file</span><span class="crayon-o">=</span><span class="crayon-v">heap</span><span class="crayon-e">.bin</span><span class="crayon-h"> </span><span class="crayon-cn">6057</span></div><div class="crayon-line crayon-striped-line" id="crayon-5467dbd5458a8177632833-8"><span class="crayon-e">Dumping </span><span class="crayon-e">heap </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">home</span><span class="crayon-o">/</span><span class="crayon-v">user</span><span class="crayon-o">/</span><span class="crayon-v">heap</span><span class="crayon-e">.bin</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5467dbd5458a8177632833-9"><span class="crayon-e">Heap </span><span class="crayon-e">dump </span><span class="crayon-r">file</span><span class="crayon-h"> </span><span class="crayon-i">created</span></div><div class="crayon-line crayon-striped-line" id="crayon-5467dbd5458a8177632833-10">&nbsp;</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>Finally copy the heap dump file (heap.bin) to your workstation and use <a title="VisualVM" href="http://visualvm.java.net/">VisualVM</a> to read the heap dump: <strong>File -&gt; Load…</strong></p>
<p>Alternatively, you can also use <a title="Java Heap Analysis Tool" href="http://docs.oracle.com/javase/7/docs/technotes/tools/share/jhat.html">jhat</a> to read heap dump files.</p>
<h2>Solution 3 (bonus). Call me</h2>
<p>You can also contact my <a title="Software Development" href="http://www.opcodesolutions.com/">application development company</a> and I can personally help you with those kind of issues <img src="./How to fix java.lang.OutOfMemoryError  Java heap space   OpCode Tech_files/icon_smile.gif" alt=":)" class="wp-smiley"></p>
					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
			This entry was posted in <a href="http://opcodesolutions.com/tech/category/development/" rel="category tag">Development</a>, <a href="http://opcodesolutions.com/tech/category/dump/" rel="category tag">dump</a>, <a href="http://opcodesolutions.com/tech/category/heap/" rel="category tag">heap</a>, <a href="http://opcodesolutions.com/tech/category/java/" rel="category tag">java</a>, <a href="http://opcodesolutions.com/tech/category/jhat/" rel="category tag">jhat</a>, <a href="http://opcodesolutions.com/tech/category/jmap/" rel="category tag">jmap</a>, <a href="http://opcodesolutions.com/tech/category/jps/" rel="category tag">jps</a>, <a href="http://opcodesolutions.com/tech/category/leak/" rel="category tag">leak</a>, <a href="http://opcodesolutions.com/tech/category/memory/" rel="category tag">memory</a>, <a href="http://opcodesolutions.com/tech/category/outofmemoryerror/" rel="category tag">outofmemoryerror</a>, <a href="http://opcodesolutions.com/tech/category/visualvm/" rel="category tag">visualvm</a> on <a href="./How to fix java.lang.OutOfMemoryError  Java heap space   OpCode Tech_files/How to fix java.lang.OutOfMemoryError  Java heap space   OpCode Tech.html" title="10:07 am" rel="bookmark"><time class="entry-date" datetime="2014-11-04T10:07:04+00:00">November 4, 2014</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href="http://opcodesolutions.com/tech/author/jdemers/" title="View all posts by Jonathan Demers" rel="author">Jonathan Demers</a></span></span>.								</footer><!-- .entry-meta -->
	</article><!-- #post -->

				<nav class="nav-single">
					<h3 class="assistive-text">Post navigation</h3>
					<span class="nav-previous"><a href="http://opcodesolutions.com/tech/java-lang-outofmemoryerror-permgen-space/" rel="prev"><span class="meta-nav">←</span> How to fix java.lang.OutOfMemoryError: PermGen space</a></span>
					<span class="nav-next"><a href="http://opcodesolutions.com/tech/programmatically-configure-hibernate-jpa-with-dbcp/" rel="next">Programmatically Configure Hibernate (JPA) with DBCP <span class="meta-nav">→</span></a></span>
				</nav><!-- .nav-single -->

				
<div id="comments" class="comments-area">

	
	
									<div id="respond" class="comment-respond">
				<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://opcodesolutions.com/tech/solve-java-lang-outofmemoryerror-java-heap-space/#respond" style="display:none;">Cancel reply</a></small></h3>
									<form action="http://opcodesolutions.com/tech/wp-comments-post.php" method="post" id="commentform" class="comment-form">
																			<p class="comment-notes">Your email address will not be published. Required fields are marked <span class="required">*</span></p>							<p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" aria-required="true" style="background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABHklEQVQ4EaVTO26DQBD1ohQWaS2lg9JybZ+AK7hNwx2oIoVf4UPQ0Lj1FdKktevIpel8AKNUkDcWMxpgSaIEaTVv3sx7uztiTdu2s/98DywOw3Dued4Who/M2aIx5lZV1aEsy0+qiwHELyi+Ytl0PQ69SxAxkWIA4RMRTdNsKE59juMcuZd6xIAFeZ6fGCdJ8kY4y7KAuTRNGd7jyEBXsdOPE3a0QGPsniOnnYMO67LgSQN9T41F2QGrQRRFCwyzoIF2qyBuKKbcOgPXdVeY9rMWgNsjf9ccYesJhk3f5dYT1HX9gR0LLQR30TnjkUEcx2uIuS4RnI+aj6sJR0AM8AaumPaM/rRehyWhXqbFAA9kh3/8/NvHxAYGAsZ/il8IalkCLBfNVAAAAABJRU5ErkJggg==); background-attachment: scroll; background-position: 100% 50%; background-repeat: no-repeat;"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" aria-required="true"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30"></p>
												<p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" aria-required="true"></textarea></p>						<p class="form-allowed-tags">You may use these <abbr title="HyperText Markup Language">HTML</abbr> tags and attributes:  <code>&lt;a href="" title=""&gt; &lt;abbr title=""&gt; &lt;acronym title=""&gt; &lt;b&gt; &lt;blockquote cite=""&gt; &lt;cite&gt; &lt;code class="" title="" data-url=""&gt; &lt;del datetime=""&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=""&gt; &lt;strike&gt; &lt;strong&gt; &lt;pre class="" title="" data-url=""&gt; &lt;span class="" title="" data-url=""&gt; </code></p>						<p class="form-submit">
							<input name="submit" type="submit" id="submit" value="Post Comment">
							<input type="hidden" name="comment_post_ID" value="12" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
						</p>
											</form>
							</div><!-- #respond -->
			
</div><!-- #comments .comments-area -->
			
		</div><!-- #content -->
	</div><!-- #primary -->


			<div id="secondary" class="widget-area" role="complementary">
			<aside id="search-2" class="widget widget_search"><form role="search" method="get" id="searchform" class="searchform" action="http://opcodesolutions.com/tech/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s">
					<input type="submit" id="searchsubmit" value="Search">
				</div>
			</form></aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
					<li>
				<a href="http://opcodesolutions.com/tech/how-to-add-a-free-client-login-to-your-website/">How to Add a Free “Client Login” to your Website</a>
						</li>
					<li>
				<a href="http://opcodesolutions.com/tech/ubuntu-apache-reverse-proxy-rewrite-html-links/">Ubuntu 14.04 Apache Reverse Proxy Rewrite HTML Links</a>
						</li>
					<li>
				<a href="http://opcodesolutions.com/tech/retiring-ftp-10-things-to-check-for-business-file-transfers/">Retiring FTP: 10 Tips for a Replacement Technology</a>
						</li>
					<li>
				<a href="http://opcodesolutions.com/tech/programmatically-configure-hibernate-jpa-with-dbcp/">Programmatically Configure Hibernate (JPA) with DBCP</a>
						</li>
					<li>
				<a href="./How to fix java.lang.OutOfMemoryError  Java heap space   OpCode Tech_files/How to fix java.lang.OutOfMemoryError  Java heap space   OpCode Tech.html">How to fix java.lang.OutOfMemoryError: Java heap space</a>
						</li>
				</ul>
		</aside><aside id="archives-2" class="widget widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
	<li><a href="http://opcodesolutions.com/tech/2014/11/">November 2014</a></li>
	<li><a href="http://opcodesolutions.com/tech/2014/05/">May 2014</a></li>
	<li><a href="http://opcodesolutions.com/tech/2010/06/">June 2010</a></li>
	<li><a href="http://opcodesolutions.com/tech/2009/11/">November 2009</a></li>
	<li><a href="http://opcodesolutions.com/tech/2009/09/">September 2009</a></li>
	<li><a href="http://opcodesolutions.com/tech/2009/04/">April 2009</a></li>
		</ul>
</aside><aside id="categories-2" class="widget widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
	<li class="cat-item cat-item-26"><a href="http://opcodesolutions.com/tech/category/anonymous/">anonymous</a>
</li>
	<li class="cat-item cat-item-46"><a href="http://opcodesolutions.com/tech/category/apache/">apache</a>
</li>
	<li class="cat-item cat-item-17"><a href="http://opcodesolutions.com/tech/category/application/">application</a>
</li>
	<li class="cat-item cat-item-47"><a href="http://opcodesolutions.com/tech/category/blogs/">blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="http://opcodesolutions.com/tech/category/class/">class</a>
</li>
	<li class="cat-item cat-item-9"><a href="http://opcodesolutions.com/tech/category/class-loader/">class-loader</a>
</li>
	<li class="cat-item cat-item-15"><a href="http://opcodesolutions.com/tech/category/company/">company</a>
</li>
	<li class="cat-item cat-item-25"><a href="http://opcodesolutions.com/tech/category/confidential/">confidential</a>
</li>
	<li class="cat-item cat-item-44"><a href="http://opcodesolutions.com/tech/category/debugging/">debugging</a>
</li>
	<li class="cat-item cat-item-28"><a href="http://opcodesolutions.com/tech/category/delicate/">delicate</a>
</li>
	<li class="cat-item cat-item-2"><a href="http://opcodesolutions.com/tech/category/development/">Development</a>
</li>
	<li class="cat-item cat-item-20"><a href="http://opcodesolutions.com/tech/category/developpement/">developpement</a>
</li>
	<li class="cat-item cat-item-30"><a href="http://opcodesolutions.com/tech/category/discussion/">discussion</a>
</li>
	<li class="cat-item cat-item-36"><a href="http://opcodesolutions.com/tech/category/dump/">dump</a>
</li>
	<li class="cat-item cat-item-22"><a href="http://opcodesolutions.com/tech/category/free/">free</a>
</li>
	<li class="cat-item cat-item-29"><a href="http://opcodesolutions.com/tech/category/freedom/">freedom</a>
</li>
	<li class="cat-item cat-item-45"><a href="http://opcodesolutions.com/tech/category/general/">General</a>
</li>
	<li class="cat-item cat-item-41"><a href="http://opcodesolutions.com/tech/category/glassfish/">glassfish</a>
</li>
	<li class="cat-item cat-item-35"><a href="http://opcodesolutions.com/tech/category/heap/">heap</a>
</li>
	<li class="cat-item cat-item-39"><a href="http://opcodesolutions.com/tech/category/ibm/">ibm</a>
</li>
	<li class="cat-item cat-item-7"><a href="http://opcodesolutions.com/tech/category/java/">java</a>
</li>
	<li class="cat-item cat-item-33"><a href="http://opcodesolutions.com/tech/category/jhat/">jhat</a>
</li>
	<li class="cat-item cat-item-32"><a href="http://opcodesolutions.com/tech/category/jmap/">jmap</a>
</li>
	<li class="cat-item cat-item-34"><a href="http://opcodesolutions.com/tech/category/jps/">jps</a>
</li>
	<li class="cat-item cat-item-37"><a href="http://opcodesolutions.com/tech/category/jvm/">jvm</a>
</li>
	<li class="cat-item cat-item-18"><a href="http://opcodesolutions.com/tech/category/leak/">leak</a>
</li>
	<li class="cat-item cat-item-11"><a href="http://opcodesolutions.com/tech/category/maxpermsize/">maxpermsize</a>
</li>
	<li class="cat-item cat-item-10"><a href="http://opcodesolutions.com/tech/category/memory/">memory</a>
</li>
	<li class="cat-item cat-item-12"><a href="http://opcodesolutions.com/tech/category/news/">News</a>
</li>
	<li class="cat-item cat-item-13"><a href="http://opcodesolutions.com/tech/category/opcode/">opcode</a>
</li>
	<li class="cat-item cat-item-38"><a href="http://opcodesolutions.com/tech/category/oracle/">oracle</a>
</li>
	<li class="cat-item cat-item-4"><a href="http://opcodesolutions.com/tech/category/outofmemoryerror/">outofmemoryerror</a>
</li>
	<li class="cat-item cat-item-3"><a href="http://opcodesolutions.com/tech/category/permgen/">permgen</a>
</li>
	<li class="cat-item cat-item-43"><a href="http://opcodesolutions.com/tech/category/remote/">remote</a>
</li>
	<li class="cat-item cat-item-48"><a href="http://opcodesolutions.com/tech/category/roller/">roller</a>
</li>
	<li class="cat-item cat-item-14"><a href="http://opcodesolutions.com/tech/category/software/">software</a>
</li>
	<li class="cat-item cat-item-16"><a href="http://opcodesolutions.com/tech/category/solutions/">solutions</a>
</li>
	<li class="cat-item cat-item-6"><a href="http://opcodesolutions.com/tech/category/space/">space</a>
</li>
	<li class="cat-item cat-item-27"><a href="http://opcodesolutions.com/tech/category/speech/">speech</a>
</li>
	<li class="cat-item cat-item-21"><a href="http://opcodesolutions.com/tech/category/subject/">subject</a>
</li>
	<li class="cat-item cat-item-40"><a href="http://opcodesolutions.com/tech/category/sun/">sun</a>
</li>
	<li class="cat-item cat-item-31"><a href="http://opcodesolutions.com/tech/category/taboo/">taboo</a>
</li>
	<li class="cat-item cat-item-42"><a href="http://opcodesolutions.com/tech/category/thread/">thread</a>
</li>
	<li class="cat-item cat-item-8"><a href="http://opcodesolutions.com/tech/category/tomcat/">tomcat</a>
</li>
	<li class="cat-item cat-item-1"><a href="http://opcodesolutions.com/tech/category/uncategorized/">Uncategorized</a>
</li>
	<li class="cat-item cat-item-24"><a href="http://opcodesolutions.com/tech/category/unpopular/">unpopular</a>
</li>
	<li class="cat-item cat-item-23"><a href="http://opcodesolutions.com/tech/category/uspeak/">uspeak</a>
</li>
	<li class="cat-item cat-item-19"><a href="http://opcodesolutions.com/tech/category/visualvm/">visualvm</a>
</li>
		</ul>
</aside>		</div><!-- #secondary -->
		</div><!-- #main .wrapper -->
	<footer id="colophon" role="contentinfo">
		<div class="site-info">
						<a href="http://opcodesolutions.com/" title="Applications for businesses">Powered by OpCode Solutions</a>
		</div><!-- .site-info -->
	</footer><!-- #colophon -->
</div><!-- #page -->

<script type="text/javascript" src="./How to fix java.lang.OutOfMemoryError  Java heap space   OpCode Tech_files/comment-reply.min.js"></script>
<script type="text/javascript" src="./How to fix java.lang.OutOfMemoryError  Java heap space   OpCode Tech_files/navigation.js"></script>

<script id="hiddenlpsubmitdiv" style="display: none;"></script><script>try{for(var lastpass_iter=0; lastpass_iter < document.forms.length; lastpass_iter++){ var lastpass_f = document.forms[lastpass_iter]; if(typeof(lastpass_f.lpsubmitorig2)=="undefined"){ lastpass_f.lpsubmitorig2 = lastpass_f.submit; lastpass_f.submit = function(){ var form=this; var customEvent = document.createEvent("Event"); customEvent.initEvent("lpCustomEvent", true, true); var d = document.getElementById("hiddenlpsubmitdiv"); if (d) {for(var i = 0; i < document.forms.length; i++){ if(document.forms[i]==form){ d.innerText=i; } } d.dispatchEvent(customEvent); }form.lpsubmitorig2(); } } }}catch(e){}</script></body></html>